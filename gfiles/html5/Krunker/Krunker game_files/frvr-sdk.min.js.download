var FRVRSDK=function(t){"use strict";var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},e(t,n)};function n(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var r,o=function(){return o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o.apply(this,arguments)};function i(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}function s(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function a(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function u(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}t.Env=void 0,(r=t.Env||(t.Env={})).DEVELOPMENT="dev",r.BETA="beta",r.PRODUCTION="prod";var c={log:function(){},error:function(){},warn:function(){},info:function(){},debug:function(){}},d=function(){function t(t){var e=t.provider,n=t.logger;this.provider=e,this.logger=n||c}return t.prototype.setItems=function(t){var e=t.map((function(t){var e=t.key,n=t.value;return{key:e,value:JSON.stringify(n)}}));return this.provider.setItems(e)},t.prototype.getItems=function(t){return s(this,void 0,void 0,(function(){var e,n,r;return a(this,(function(o){switch(o.label){case 0:return[4,this.provider.getItems(t)];case 1:for(r in e=o.sent(),n={},e)try{n[r]=JSON.parse(e[r])}catch(t){this.logger.error("[storage] parsing error on key ".concat(r),t.message)}return[2,n]}}))}))},t.prototype.removeItems=function(t){return this.provider.removeItems(t)},t.prototype.setItem=function(t,e){return this.provider.setItems([{key:t,value:JSON.stringify(e)}])},t.prototype.getItem=function(t,e){return s(this,void 0,void 0,(function(){var n,r,o;return a(this,(function(i){switch(i.label){case 0:return[4,this.provider.getItems([t])];case 1:n=i.sent();try{o=n[t],r=void 0!==o?JSON.parse(o):e}catch(n){r=e,this.logger.error("[storage] parsing error on key ".concat(t),n.message)}return[2,r]}}))}))},t.prototype.removeItem=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){return[2,this.provider.removeItems([t])]}))}))},t.prototype.isPersistent=function(){return this.provider.isPersistent()},t}(),h=function(){function t(){}return t.isSupported=function(){try{return window.localStorage,!0}catch(t){return!1}},t.prototype.setItems=function(t){return s(this,void 0,void 0,(function(){var e,n,r;return a(this,(function(o){for(e=0,n=t;e<n.length;e++)r=n[e],window.localStorage.setItem(r.key,r.value);return[2]}))}))},t.prototype.getItems=function(t){return s(this,void 0,void 0,(function(){var e,n,r,o,i;return a(this,(function(s){for(e={},n=0,r=t;n<r.length;n++)o=r[n],null!==(i=window.localStorage.getItem(o))&&(e[o]=i);return[2,e]}))}))},t.prototype.removeItems=function(t){return s(this,void 0,void 0,(function(){var e,n,r;return a(this,(function(o){for(e=0,n=t;e<n.length;e++)r=n[e],window.localStorage.removeItem(r);return[2]}))}))},t.prototype.isPersistent=function(){return!0},t.providerName="web",t}(),l=function(){function t(){this.values={}}return t.prototype.setItems=function(t){return s(this,void 0,void 0,(function(){var e,n,r;return a(this,(function(o){for(e=0,n=t;e<n.length;e++)r=n[e],this.values[r.key]=r.value;return[2]}))}))},t.prototype.getItems=function(t){return s(this,void 0,void 0,(function(){var e,n,r,o,i;return a(this,(function(s){for(e={},n=0,r=t;n<r.length;n++)o=r[n],void 0!==(i=this.values[o])&&(e[o]=i);return[2,e]}))}))},t.prototype.removeItems=function(t){return s(this,void 0,void 0,(function(){var e,n,r;return a(this,(function(o){for(e=0,n=t;e<n.length;e++)r=n[e],delete this.values[r];return[2]}))}))},t.prototype.isPersistent=function(){return!1},t.providerName="memory",t}(),p=new d({provider:new l}),f=function(t){for(var e=0,n=t;e<n.length;e++){switch(n[e]){case h.providerName:if(h.isSupported())return new h;break;case l.providerName:return new l;default:throw new Error("Unsupported Local Storage provider")}}throw new Error("Error initializing Local Storage provider")},g={init:function(){return Promise.resolve()},setProgress:function(){},complete:function(){return Promise.resolve()}};function v(){this.code="INVALID_OPERATION",this.message="Trying to use an empty interface."}var m={init:function(){return s(void 0,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},canCreateShortcut:function(){return Promise.resolve(!1)},createShortcut:function(){return Promise.reject(new v)}};function y(){this.code="INVALID_OPERATION",this.message="Trying to use an empty interface."}var I,P={needsConfiguration:function(){return!1},canMoveToMobile:function(){return Promise.resolve(!1)},moveToMobile:function(){return Promise.reject(new y)}};t.ConsentOptions=void 0,(I=t.ConsentOptions||(t.ConsentOptions={}))[I.None=0]="None",I[I.P1StoreInformationOnADevice=2]="P1StoreInformationOnADevice",I[I.P2SelectBasicAds=4]="P2SelectBasicAds",I[I.P3PersonalizedAdsProfile=8]="P3PersonalizedAdsProfile",I[I.P4PersonalizedAds=16]="P4PersonalizedAds",I[I.P5PersonalizedContentProfile=32]="P5PersonalizedContentProfile",I[I.P6PersonalizedContent=64]="P6PersonalizedContent",I[I.P7MeasureAdPerformance=128]="P7MeasureAdPerformance",I[I.P8MeasureContentPerformance=256]="P8MeasureContentPerformance",I[I.P9MarketResearchForAudienceInsights=512]="P9MarketResearchForAudienceInsights",I[I.P10DevelopAndImproveProducts=1024]="P10DevelopAndImproveProducts",I[I.All=2046]="All";var S,b,E={consentToTerms:function(){},onConsentChanged:function(t){},hasConsentForAll:function(t,e){return!1},hasConsentForAny:function(t,e){return!1},consents:function(){return t.ConsentOptions.None},legitimateInterests:function(){return t.ConsentOptions.None},hasLoaded:function(){return!0}},_={consentToTerms:function(){},onConsentChanged:function(t){},hasConsentForAll:function(t,e){return!0},hasConsentForAny:function(t,e){return!0},consents:function(){return t.ConsentOptions.All},legitimateInterests:function(){return t.ConsentOptions.All},hasLoaded:function(){return!0}},w={id:function(){return""},name:function(){return""},image:function(){return""},loadImage:function(){return Promise.reject(new Error("EMPTY_PROFILE"))}},A={allowExternalLinks:!0,allowInternalLinks:!0,allowNavigation:!0,hasDedicatedLoadingScreen:!0},C={getData:function(){return Promise.reject(new Error("EMPTY_ENTRYPOINT_DATA"))},getName:function(){return Promise.reject(new Error("EMPTY_ENTRYPOINT_NAME"))}},T={canFollowOfficialPage:function(){return Promise.resolve(!1)},followOfficialPage:function(){return Promise.reject(new Error("EMPTY_FOLLOW_OFFICIAL_PAGE"))},canJoinOfficialGroup:function(){return Promise.resolve(!1)},joinOfficialGroup:function(){return Promise.reject(new Error("EMPTY_FOLLOW_OFFICIAL_GROUP"))}};t.AdType=void 0,(b=t.AdType||(t.AdType={})).INTERSTITIAL="interstitial",b.REWARD="reward",b.BANNER="banner",b.SURVEY="survey",b.REWARDED_INTERSTITIAL="rewarded-interstitial";var R,k,O,N=((S={})[t.AdType.INTERSTITIAL]={stopsGameFlow:!0,throttleable:!0},S[t.AdType.REWARD]={stopsGameFlow:!0,throttleable:!1},S[t.AdType.BANNER]={stopsGameFlow:!1,throttleable:!1},S[t.AdType.SURVEY]={stopsGameFlow:!0,throttleable:!0},S[t.AdType.REWARDED_INTERSTITIAL]={stopsGameFlow:!0,throttleable:!0},S),L={onSuspend:function(){},onResume:function(){},onAudioSuspend:function(){},onAudioResume:function(){}},F={logEvent:function(){}};t.AdResponseStatus=void 0,(k=t.AdResponseStatus||(t.AdResponseStatus={})).AD_CLOSED="adclosed",k.AD_LEAVING_APPLICATION="adleavingapplication",k.CANCELED="canceled",k.ERROR="error",k.INTERNAL_ERROR="internalerror",k.INVALID_REQUEST="invalidrequest",k.NETWORK_ERROR="networkerror",k.NOFILL="nofill",k.SUCCESS="success",k.THROTTLED="throttled",k.TIMEOUT="timeout",t.AdFinishedStatus=void 0,(O=t.AdFinishedStatus||(t.AdFinishedStatus={})).ERROR="error",O.NOFILL="nofill",O.SKIPPED="skipped",O.SUCCESS="success",O.TIMEDOUT="timedout";var D,U,V=((R={})[t.AdType.INTERSTITIAL]="mandatory",R[t.AdType.REWARD]="rewarded",R),M=function(){function e(t,e){this.tracker=t,this.params=e}return e.prototype.getEventName=function(t){var e,n=null!==(e=V[this.params.adType])&&void 0!==e?e:this.params.adType;return"ad_".concat(n,"_").concat(t)},e.prototype.logEvent=function(e,n){this.tracker.logEvent(e,n,t.ConsentOptions.None)},e.prototype.requestingAd=function(t,e){var n=this.getEventName("request");this.logEvent(n,o(o({},e),{provider:this.params.provider,advertisement_id:t}))},e.prototype.receivedAdResponse=function(t,e,n){var r=this.getEventName("response");this.logEvent(r,o(o({},n),{provider:this.params.provider,advertisement_id:e,ad_response:t}))},e.prototype.willShowAd=function(t,e,n){var r=this.getEventName("show");this.logEvent(r,o(o({},n),{provider:this.params.provider,advertisement_id:e,preloaded:t}))},e.prototype.finishedAd=function(t,e,n){var r=this.getEventName("finish");this.logEvent(r,o(o({},n),{provider:this.params.provider,advertisement_id:e,ad_result:t}))},e}();t.AdSuccess=void 0,(D=t.AdSuccess||(t.AdSuccess={})).DELIVERED="delivered",D.COMPLETED="completed",t.AdError=void 0,(U=t.AdError||(t.AdError={})).ON_LOAD="on_load",U.ON_SHOW="on_show",U.BLOCKED="blocked",U.NOFILL="nofill",U.TIMED_OUT="timed_out";var x,B=function(){function e(t){this.type=t}return e.prototype.getName=function(){return"dev"},e.prototype.getType=function(){return this.type},e.prototype.isReady=function(){return!0},e.prototype.useManualControl=function(){return!1},e.prototype.init=function(t,e,n){var r=this;return this.tracker=n,new Promise((function(t){setTimeout((function(){console.log("[dev] ".concat(r.type," ad initialised")),t()}),100)}))},e.prototype.show=function(){var e,n,r,o,i;null===(e=this.tracker)||void 0===e||e.requestingAd(),null===(n=this.tracker)||void 0===n||n.receivedAdResponse(t.AdResponseStatus.SUCCESS),null===(r=this.tracker)||void 0===r||r.willShowAd(!1),console.log("[dev] ".concat(this.type," ad displayed"));var s=confirm("Want to check out this ad?");s?(console.log("[dev] ".concat(this.type," ad checked")),null===(o=this.tracker)||void 0===o||o.finishedAd(t.AdFinishedStatus.SUCCESS)):(console.log("[dev] ".concat(this.type," ad skipped/dismissed")),null===(i=this.tracker)||void 0===i||i.finishedAd(t.AdFinishedStatus.SKIPPED));var a={success:!0,code:s?t.AdSuccess.COMPLETED:t.AdSuccess.DELIVERED};return Promise.resolve(a)},e}(),j=function(e){function r(){return e.call(this,t.AdType.INTERSTITIAL)||this}return n(r,e),r}(B),G=function(e){function r(){return e.call(this,t.AdType.REWARD)||this}return n(r,e),r}(B);t.AdsThrottlerResult=void 0,(x=t.AdsThrottlerResult||(t.AdsThrottlerResult={}))[x.NO_THROTTLING=0]="NO_THROTTLING",x.INIT_TIME="INIT_TIME",x.FREQUENCY="FREQUENCY";var W,H=function(){function e(){this.maxfrequency=0,this.initTimeBlock=0,this.forceFirstAd=!1,this.MAX_FREQUENCY_DEFAULT=3e5,this.FIRST_SESSION_AD_SPEED_RATE=3}return e.prototype.getFirstIntervalTime=function(t){var e=t.isFirstAdEver?this.maxfrequency:this.maxfrequency/this.FIRST_SESSION_AD_SPEED_RATE;return t.initTime-e},e.prototype.getInitialisedState=function(t){return t.lastShownAd?t:o(o({},t),{lastShownAd:this.getFirstIntervalTime(t)})},e.prototype.shouldBlockByInitTime=function(t,e){return e-t.initTime<this.initTimeBlock},e.prototype.shouldBlockByFrequency=function(t,e){var n=e-t.lastShownAd;return this.maxfrequency>0&&n<this.maxfrequency&&!(t.isFirstAd&&this.forceFirstAd)},e.prototype.init=function(t){this.initTimeBlock=t.initTimeBlock||0,this.maxfrequency=void 0===t.maxfrequency?this.MAX_FREQUENCY_DEFAULT:t.maxfrequency,this.forceFirstAd=t.forceFirstAd||!1},e.prototype.mustThrottle=function(e,n){n=void 0===n?(new Date).getTime():n;var r=this.getInitialisedState(e);return this.shouldBlockByInitTime(r,n)?t.AdsThrottlerResult.INIT_TIME:this.shouldBlockByFrequency(r,n)?t.AdsThrottlerResult.FREQUENCY:t.AdsThrottlerResult.NO_THROTTLING},e.prototype.checkpoint=function(t,e){return e=void 0===e?(new Date).getTime():e,o(o({},t),{isFirstAd:!1,isFirstAdEver:!1,lastShownAd:e})},e}(),K={get:function(){return Promise.resolve({})}};t.AdShowResult=void 0,(W=t.AdShowResult||(t.AdShowResult={})).NOT_DISPLAYED="not_displayed",W.DELIVERED="delivered",W.COMPLETED="completed";var q,Y=function(){function e(e){var n=void 0===e?{}:e,r=n.logger,o=void 0===r?c:r,i=n.throttler,s=n.storage,a=void 0===s?p:s,u=n.tracker,d=void 0===u?F:u,h=n.controls,l=void 0===h?L:h;this.config={},this.registeredProviders={},this.providers=[],this.ADSTORAGE_FIRST_TIME_KEY="__ads_firstTimeView",this.AdType=t.AdType,this.AdShowResult=t.AdShowResult,this.logger=o,this.throttler=i||new H,this.storage=a,this.tracker=d,this.controls=l,this.throttlerState={initTime:(new Date).getTime(),isFirstAd:!0,isFirstAdEver:!1,lastShownAd:0}}return e.prototype.register=function(t){var e="".concat(t.getName(),"#").concat(t.getType());this.registeredProviders[e]=t},e.prototype.configure=function(t){this.config=t},e.prototype.init=function(){return s(this,void 0,void 0,(function(){var t,e,n,r,o,i,s=this;return a(this,(function(a){switch(a.label){case 0:return t=this.throttlerState,[4,this.storage.getItem(this.ADSTORAGE_FIRST_TIME_KEY,!0)];case 1:return t.isFirstAdEver=a.sent()||!1,this.logger.log("[ads] first time ever?",this.throttlerState.isFirstAdEver),this.throttler.init(this.config.throttling||{}),e=this.config.providers||[],(n=u([],e,!0)).sort((function(t,e){return t.priority-e.priority})),r=n.map((function(t){var e="".concat(t.name,"#").concat(t.type);return{provider:s.registeredProviders[e],providerConfig:t,key:e}})).filter((function(t){return t.provider})).map((function(t){var e=t.provider,n=t.providerConfig,r=t.key,o=new M(s.tracker,{adType:e.getType(),provider:e.getName()});return e.init(n,s.controls,o).then((function(){return e})).catch((function(t){s.logger.warn("[ads] Ad provider ".concat(r," could not be initialised"),t)}))})),[4,Promise.all(r)];case 2:return o=a.sent(),i=o.filter((function(t){return void 0!==t})),this.providers=i,[2]}}))}))},e.prototype.getProviders=function(){return this.providers},e.prototype.getProvidersByType=function(t){return this.providers.filter((function(e){return e.getType()===t}))},e.prototype.isReady=function(t){return void 0!==this.getProvidersByType(t).find((function(t){return t.isReady()}))},e.prototype.show=function(e){return s(this,void 0,void 0,(function(){var n,r,o,i,u=this;return a(this,(function(c){switch(c.label){case 0:return N[e].throttleable&&(n=this.throttler.mustThrottle(this.throttlerState))?(this.logger.log("[ads] Ad was throttled, reason =",n),[2,Promise.resolve(t.AdShowResult.NOT_DISPLAYED)]):(r=this.getProvidersByType(e),o=!1,[4,(d=r,h=function(t){return s(u,void 0,void 0,(function(){var n,r;return a(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),t.isReady()?(N[e].stopsGameFlow&&!t.useManualControl()&&(this.controls.onSuspend(),this.controls.onAudioSuspend(),o=!0),[4,t.show()]):(this.logger.warn("[ads] provider",t.getName(),"not ready"),[2]);case 1:return!1===(n=i.sent()).success&&this.logger.error("[ads] show error",n.message),[2,n.success?n.code:void 0];case 2:return r=i.sent(),this.logger.error("[ads] show error",r),[3,3];case 3:return[2]}}))}))},l=function(t){var e=d[t];return e?h(e).then((function(e){return void 0===e?l(t+1):e})):Promise.resolve(void 0)},l(0))]);case 1:return i=c.sent(),N[e].stopsGameFlow&&o&&(this.controls.onAudioResume(),this.controls.onResume()),void 0===i?[3,3]:(this.throttlerState=this.throttler.checkpoint(this.throttlerState),[4,this.storage.setItem(this.ADSTORAGE_FIRST_TIME_KEY,!1)]);case 2:return c.sent(),[2,i===t.AdSuccess.COMPLETED?t.AdShowResult.COMPLETED:t.AdShowResult.DELIVERED];case 3:return[2,t.AdShowResult.NOT_DISPLAYED]}var d,h,l}))}))},e.prototype.setUserConsent=function(t){this.providers.forEach((function(e){var n;return null===(n=e.setUserConsent)||void 0===n?void 0:n.call(e,t)}))},e}(),z=function(){function t(t,e){this.auth=e,this.baseUrl=t.replace(/\/$/,"")}return t.prototype.getFriends=function(t){var e;return s(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:return[4,null===(e=this.auth)||void 0===e?void 0:e.authenticatedFetch("".concat(this.baseUrl,"/friends/").concat(t),{method:"GET",headers:{"Content-Type":"application/json"}})];case 1:if(!(null==(n=r.sent())?void 0:n.ok))throw new J(n);return[4,n.json()];case 2:return[2,r.sent()]}}))}))},t.prototype.addFriend=function(t,e){var n;return s(this,void 0,void 0,(function(){var r;return a(this,(function(o){switch(o.label){case 0:return[4,null===(n=this.auth)||void 0===n?void 0:n.authenticatedFetch("".concat(this.baseUrl,"/friends/").concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})];case 1:if(!(null==(r=o.sent())?void 0:r.ok))throw new J(r);return[4,r.json()];case 2:return[2,o.sent()]}}))}))},t.prototype.removeFriend=function(t,e){var n;return s(this,void 0,void 0,(function(){var r;return a(this,(function(o){switch(o.label){case 0:return[4,null===(n=this.auth)||void 0===n?void 0:n.authenticatedFetch("".concat(this.baseUrl,"/friends/").concat(t),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})];case 1:if(!(null==(r=o.sent())?void 0:r.ok))throw new J(r);return[2]}}))}))},t.prototype.syncFriends=function(t,e){var n;return s(this,void 0,void 0,(function(){var r;return a(this,(function(o){switch(o.label){case 0:return[4,null===(n=this.auth)||void 0===n?void 0:n.authenticatedFetch("".concat(this.baseUrl,"/friends/").concat(t,"/sync"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})];case 1:if(!(null==(r=o.sent())?void 0:r.ok))throw new J(r);return[4,r.json()];case 2:return[2,o.sent()]}}))}))},t}(),J=function(t){function e(e){var n=t.call(this,e.statusText)||this;return n.response=e,n.response=e,n.name="ResponseError",n}return n(e,t),e}(Error);!function(t){t[t.shareMessage=0]="shareMessage",t[t.sendUpdate=1]="sendUpdate",t[t.invite=2]="invite",t[t.getFriends=3]="getFriends"}(q||(q={}));var Q,X,$,Z=function(){function t(t){var e=t.provider;this.API=q,this.provider=e}return t.prototype.shareMessage=function(t){return this.provider.shareMessage(t)},t.prototype.sendUpdate=function(t){return this.provider.sendUpdate(t)},t.prototype.invite=function(t){return this.provider.invite(t)},t.prototype.getFriends=function(){return this.provider.getFriends()},t.prototype.getSupportedAPIs=function(){return this.provider.getSupportedAPIs()},t.prototype.isSupportedAPI=function(t){return-1!==this.provider.getSupportedAPIs().indexOf(t)},t}(),tt={shareMessage:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},sendUpdate:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},invite:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},getFriends:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2,Promise.resolve([])]}))}))},getSupportedAPIs:function(){return[]}};!function(t){t.UPDATE_STATUS="UPDATE_STATUS",t.SEND_GAME_INVITE="SEND_GAME_INVITE"}(Q||(Q={})),function(t){t.onFriendStatusUpdated="FRIEND_STATUS_UPDATED",t.onConnect="ON_CONNECT",t.onGameInvite="RECEIVE_GAME_INVITE",t.onError="ON_ERROR"}(X||(X={})),function(t){t.open="open",t.close="close",t.error="error",t.message="message",t.retry="retry"}($||($={}));var et=function(){function t(t){var e,n=this;this.retries=0,this.eventListeners={open:[],close:[],error:[],message:[],retry:[]},this.closedByUser=!1,this.RECONNECT_DEFAULT_BACKOFF_MS=1e3,this.RECONNECT_RETRY_MS=500,this.onOpen=function(t){return n.handleEvent($.open,t)},this.onClose=function(t){return n.handleEvent($.close,t)},this.onError=function(t){return n.handleEvent($.error,t)},this.onMessage=function(t){return n.handleEvent($.message,t)},this.url=t.url,this.logger=t.logger,this.webSocketBuilder=null!==(e=t.webSocketBuilder)&&void 0!==e?e:function(t){return new WebSocket(t)}}return t.prototype.send=function(t){this.websocket?this.getConnectionStatus()===WebSocket.OPEN?this.closedByUser?this.logger.error("WebsocketClient: Cannot send message, closed by user"):this.websocket.send(t):this.logger.error("WebsocketClient: Cannot send message, not connected"):this.logger.error("WebsocketClient: Cannot send message, not initialised")},t.prototype.connect=function(){return s(this,void 0,void 0,(function(){var t,e;return a(this,(function(n){switch(n.label){case 0:return this.closedByUser=!1,void 0!==this.websocket&&(this.websocket.removeEventListener($.open,this.onOpen),this.websocket.removeEventListener($.close,this.onClose),this.websocket.removeEventListener($.error,this.onError),this.websocket.removeEventListener($.message,this.onMessage),this.websocket.close()),t=this,e=this.webSocketBuilder,[4,this.url()];case 1:return t.websocket=e.apply(this,[n.sent()]),this.websocket.addEventListener($.open,this.onOpen),this.websocket.addEventListener($.close,this.onClose),this.websocket.addEventListener($.error,this.onError),this.websocket.addEventListener($.message,this.onMessage),[2]}}))}))},t.prototype.close=function(t,e){var n;this.closedByUser=!0,null===(n=this.websocket)||void 0===n||n.close(t,e)},t.prototype.addEventListener=function(t,e){var n={listener:e};this.eventListeners[t].push(n)},t.prototype.removeEventListener=function(t,e){this.eventListeners[t]=this.eventListeners[t].filter((function(t){return t.listener!==e}))},t.prototype.getConnectionStatus=function(){return this.websocket?this.websocket.readyState:WebSocket.CLOSED},t.prototype.handleEvent=function(t,e){switch(t){case $.close:this.closedByUser||this.reconnect();break;case $.open:this.retries=0;case $.error:case $.message:}this.dispatchEvent(t,e)},t.prototype.reconnect=function(){var t=this,e=this.RECONNECT_RETRY_MS*this.retries+this.RECONNECT_DEFAULT_BACKOFF_MS,n={detail:{retries:this.retries++,backoff:e}};setTimeout((function(){if(!t.closedByUser){var e=new CustomEvent($.retry,n);t.dispatchEvent($.retry,e),t.connect()}}),e)},t.prototype.dispatchEvent=function(t,e){this.eventListeners[t].forEach((function(t){t.listener(e)}))},t}(),nt=function(){function t(t,e){var n,r=this;this.friendsStatus=new Map,this.eventListeners=((n={})[X.onFriendStatusUpdated]=[],n[X.onConnect]=[],n[X.onGameInvite]=[],n[X.onError]=[],n),this.SocialEvents=X;var o=t.apiHost,i=t.gameId;if(this.apiHost=o,this.gameId=i,this.logger=e.logger,this.auth=e.auth,this.websocket=e.webSocketClientBuilder?e.webSocketClientBuilder():new et({logger:this.logger,url:function(){return r.getFreshUrl(r.apiHost,r.gameId)}}),!this.websocket)throw new Error("websocket client is not defined");this.on(X.onConnect,(function(t){for(var e=0,n=t.data.friends;e<n.length;e++){var o=n[e];r.friendsStatus.set(o.userId,o)}})),this.on(X.onFriendStatusUpdated,(function(t){var e=t.data;r.friendsStatus.set(e.userId,e)})),this.websocket.addEventListener($.open,(function(){r.logger.log("connected to social server")})),this.websocket.addEventListener($.close,(function(t){r.logger.log("websocket client closed",t)})),this.websocket.addEventListener($.error,(function(t){r.logger.error("websocket client error",t)})),this.websocket.addEventListener($.message,(function(t){var e=t.data,n=JSON.parse(e);Object.values(X).includes(n.code)?r.dispatchEvent(n.code,n):r.logger.error("event type is not supported")})),this.auth.addStatusChangeListener((function(t){return r.onAuthStatusChanged(t)}))}return t.prototype.connect=function(){var t=this.connectedUser===this.auth.getFRVRID(),e=this.websocket.getConnectionStatus();(e!==WebSocket.OPEN&&e!==WebSocket.CONNECTING||!t)&&(this.connectedUser=this.auth.getFRVRID(),this.websocket.connect())},t.prototype.close=function(){this.friendsStatus.clear(),this.connectedUser=void 0,this.websocket.close()},t.prototype.on=function(t,e){var n={listener:e},r=this.eventListeners[t];if(!r)throw new Error('event type "'.concat(t,'" is not supported'));r.push(n)},t.prototype.getFriendsStatus=function(){return Array.from(this.friendsStatus.values())},t.prototype.sendGameInvite=function(t,e,n){var r={code:Q.SEND_GAME_INVITE,data:{recipientId:t,lobbyId:e,gameId:this.gameId,metadata:n}};this.send(r)},t.prototype.updateStatus=function(t){var e={code:Q.UPDATE_STATUS,data:{metadata:t,gameId:this.gameId}};this.send(e)},t.prototype.dispatchEvent=function(t,e){this.eventListeners[t].forEach((function(t){t.listener(e)}))},t.prototype.send=function(t){this.websocket.send(JSON.stringify(t))},t.prototype.onAuthStatusChanged=function(t){return s(this,void 0,void 0,(function(){var e;return a(this,(function(n){return t?(e=this.websocket.getConnectionStatus())!==WebSocket.OPEN&&e!==WebSocket.CONNECTING||this.connect():this.close(),[2]}))}))},t.prototype.getFreshUrl=function(t,e){return s(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:return[4,this.auth.getFreshAccessToken()];case 1:return n=r.sent(),[2,"wss://".concat(t,"/ws?token=").concat(n,"&gameId=").concat(e)]}}))}))},t}(),rt=function(){function e(e,n){var r,i;this.config=e,this.container=n,this.API=q,this.auth=n.auth,this.provider=null!==(r=n.provider)&&void 0!==r?r:tt,this.gameId=e.gameId;var s=null!==(i=e.apiHostOverride)&&void 0!==i?i:e.env===t.Env.PRODUCTION?"crucible.frvr.com":"staging.crucible.frvr.com";s+="/v1/social",this.webClient=new z("https://".concat(s),this.auth),this.wsClient=new nt(o(o({},this.config),{apiHost:s}),this.container),this.socialPlatform=new Z({provider:this.provider}),this.auth.addStatusChangeListener(this.onAuthStatusChange.bind(this))}return Object.defineProperty(e.prototype,"live",{get:function(){return this.wsClient},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"platform",{get:function(){return this.socialPlatform},enumerable:!1,configurable:!0}),e.prototype.syncFriends=function(){return s(this,void 0,void 0,(function(){var t,e,n,r,o,i,s,u,c,d;return a(this,(function(a){switch(a.label){case 0:return[4,this.provider.getFriends()];case 1:t=a.sent(),e=t.reduce((function(t,e){var n,r=null!==(n=t.get(e.channel))&&void 0!==n?n:[];return r.push(e.id),t.set(e.channel,r),t}),new Map),n=[],r=Array.from(e.entries()),o=0,i=r,a.label=2;case 2:return o<i.length?(s=i[o],u=s[0],c=s[1],[4,this.webClient.syncFriends(this.getUserId(),{channel:u,gameId:this.gameId,friendIds:c})]):[3,5];case 3:d=a.sent(),n.push.apply(n,d),a.label=4;case 4:return o++,[3,2];case 5:return[2,n]}}))}))},e.prototype.getAllFriends=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.webClient.getFriends(this.getUserId())];case 1:return[2,t.sent()]}}))}))},e.prototype.addFriend=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.webClient.addFriend(this.getUserId(),{friendId:t})];case 1:return[2,e.sent()]}}))}))},e.prototype.removeFriend=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.webClient.removeFriend(this.getUserId(),{friendId:t})];case 1:return[2,e.sent()]}}))}))},e.prototype.getUserId=function(){var t=this.auth.getFRVRID();if(null===t)throw new ot("not logged in");return t},e.prototype.onAuthStatusChange=function(t){t&&this.syncFriends()},e.prototype.shareMessage=function(t){return this.socialPlatform.shareMessage(t)},e.prototype.sendUpdate=function(t){return this.socialPlatform.sendUpdate(t)},e.prototype.invite=function(t){return this.socialPlatform.invite(t)},e.prototype.getFriends=function(){return this.socialPlatform.getFriends()},e.prototype.getSupportedAPIs=function(){return this.socialPlatform.getSupportedAPIs()},e.prototype.isSupportedAPI=function(t){return this.socialPlatform.isSupportedAPI(t)},e}(),ot=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e}(Error),it="coeus.frvr.com/v1/tm5";function st(t){var e;void 0===t&&(t=function(){return new XMLHttpRequest});var n=[],r=null,i=navigator&&"function"==typeof navigator.sendBeacon,u=!1,c={protocol_version:"f",app_version:"av",engine_version:"ev",app_build:"ab",cohort:"co",channel:"ch",cmp_consents:"cmpc",cmp_legitimateInterests:"cmpl",games_played:"gp",play_session_id:"pi",play_session_count:"pc",days_elapsed:"de",facebook_player_id:"fi",facebook_context_type:"fc",facebook_entrypoint:"fe",facebook_referral_player_id:"fr",utm_source:"us",utm_medium:"um",utm_campaign:"uc",utm_term:"ut",utm_content:"uo",remote_user_id:"ru",global_user_id:"guid",device_width:"dw",device_height:"dh",non_interaction:"ni",country:"ct",event:"e",game:"g",user:"u",client_time:"t",value:"v",provider:"ao",ad_result:"ar",ad_response:"ag",ad_point:"ap",transport:"tr",web_url:"wu",retry:"r",label:"l",advertisement_id:"ai",script_version:"xv",cache_buster:"n",page_session_id:"si"};function d(t,e,n){n=void 0!==n?n:5,t(e,(function(){if(n>0){var r=5e3*(Math.pow(2,5-n)+Math.random());e.r=5-n+1,setTimeout(d.bind(void 0,t,e,--n),r)}}))}function h(t,e,n){if(navigator.sendBeacon(t,JSON.stringify(e)))return!0;n()}function l(e,n,r){var o=t();o.overrideMimeType&&o.overrideMimeType("text/plain; charset=UTF-8");try{o.open("POST",e,!0),o.setRequestHeader("Content-type","text/plain; charset=UTF-8"),o.withCredentials=!0,o.onreadystatechange=function(){if(4==o.readyState){var t=o.status;o=o.onreadystatechange=null,200!=t&&204!=t?r():u=!0}},o.send(JSON.stringify(n))}catch(t){r()}}function p(t,e,n){e.n=Math.random();var r=document.createElement("img");r.onload=function(){u=!0,r.onerror=r.onload=null},r.onerror=function(){n(),r.onerror=null},r.src=t+"?"+function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(encodeURIComponent(n)+"="+(void 0!==t[n]&&null!=t[n]?encodeURIComponent(t[n]):""));return e.join("&")}(e),document.body.appendChild(r)}function f(t,e){return i&&u?(e.transport="bcn",h.bind(void 0,t)):XMLHttpRequest?(e.transport="xhr",l.bind(void 0,t)):(e.transport="img",p.bind(void 0,t+"/i"))}function g(t){var n=t.channel,r=void 0;document&&document.location&&document.location.href&&(r=document.location.href);var o=null==e?void 0:e.getGlobalUserId(),i=null==e?void 0:e.getUserSource(),s=["https://",it,t.context||"_unspecified_",o||""].join("/");t.app_version=t.app_version||"0.0.0",t.app_build=t.app_build||"000000",t.channel=n||t.channel,t.web_url=r,t.script_version="2.0.1",t.protocol_version=5,t.cache_buster=Math.random(),t.referrer=document.referrer||null,void 0!==o&&(t.global_user_id=o),void 0!==i&&(t.global_user_id_source=i);var a=60*(new Date).getTimezoneOffset()*1e3;t.client_time=new Date(Date.now()-a).toISOString().slice(0,-1),d(f(s,t),function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&void 0!==t[n]&&null!=t[n]&&(e[c[n]||n]=t[n]);return e}(t))}return{init:function(t,n){return s(this,void 0,void 0,(function(){return a(this,(function(t){return e=n,[2]}))}))},getName:function(){return"FRVRAnalytics"},send:function(t,e,i,s){var a;i=o(o(o(void 0!==e?{value:e}:{},i),s),{event:t}),a=i,n.push(a),r&&clearTimeout(r),r=setTimeout((function(){for(;n.length>0;)g(n.shift())}),1)}}}var at,ut=function(){function t(t){this.legacyAnalytics=null!=t?t:st()}return t.prototype.init=function(t,e){return this.legacyAnalytics.init(t,e)},t.prototype.getName=function(){return this.legacyAnalytics.getName()},t.prototype.send=function(t,e,n,r){this.legacyAnalytics.send(t,e,n,r)},t}();t.AnalyticsIDProviderStorageType=void 0,(at=t.AnalyticsIDProviderStorageType||(t.AnalyticsIDProviderStorageType={})).IN_MEMORY="in-memory",at.COOKIE="cookie",at.LOCAL_STORAGE="localStorage";var ct={init:function(){return s(void 0,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},getName:function(){return""},getUserSource:function(){return t.AnalyticsIDProviderStorageType.IN_MEMORY},getPageSessionId:function(){return""},getPlaySessionId:function(){return""},getGlobalUserId:function(){return""}};function dt(t){return(t<10?"0":"")+t}function ht(t){var e=t||"-";function n(){return(65536*(1+Math.random())|0).toString(16).substring(1)}var r=(new Date).getTime().toString(16).slice(0,11)+(65536*(1+Math.random())|0).toString(16).substring(1,2);return n()+n()+e+n()+e+n()+e+n()+e+r}var lt=function(){function e(e){this.storage=e,this.PLAY_SESSION_TIMEOUT=18e5,this.globalUserIdSource=t.AnalyticsIDProviderStorageType.COOKIE,this.canUseCookies=!1}return e.prototype.setCanUseCookies=function(){document&&void 0!==document.cookie?(document.cookie="can_use_cookies=test;",this.canUseCookies=document.cookie.indexOf("can_use_cookies")>-1):this.canUseCookies=!1},e.prototype.init=function(){return s(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return this.setCanUseCookies(),this.canUseCookies?this.globalUserIdSource=t.AnalyticsIDProviderStorageType.COOKIE:this.storage.isPersistent()?this.globalUserIdSource=t.AnalyticsIDProviderStorageType.LOCAL_STORAGE:this.globalUserIdSource=t.AnalyticsIDProviderStorageType.IN_MEMORY,[4,this.storage.getItems(["pageSessionId","playSessionId","playSessionIdTimeStamp","globalUserId"])];case 1:return e=n.sent(),this.pageSessionId=e.pageSessionId&&String(e.pageSessionId),this.playSessionId=e.playSessionId&&String(e.playSessionId),this.playSessionIdTimeStamp=e.playSessionIdTimeStamp&&parseInt(String(e.playSessionIdTimeStamp),10),this.globalUserId=e.globalUserId&&String(e.globalUserId),[2]}}))}))},e.prototype.getName=function(){return"FRVRAnalytics"},e.prototype.getUserSource=function(){return this.globalUserIdSource},e.prototype.getPageSessionId=function(){return this.pageSessionId||(this.pageSessionId=ht(),this.storage.setItem("pageSessionId",this.pageSessionId)),this.pageSessionId},e.prototype.getPlaySessionId=function(){this.playSessionId&&(this.playSessionIdTimeStamp+this.PLAY_SESSION_TIMEOUT<Date.now()&&(this.playSessionId=void 0));return this.playSessionId||(this.playSessionId=ht(),this.storage.setItem("playSessionId",this.playSessionId)),this.playSessionIdTimeStamp=Date.now(),this.storage.setItem("playSessionIdTimeStamp",this.playSessionIdTimeStamp),this.playSessionId},e.prototype.getGlobalUserId=function(){return this.canUseCookies?this.getGlobalUserIdFromCookie():this.getGlobalUserIdFromStorage()},e.prototype.getGlobalUserIdFromStorage=function(){return this.globalUserId||(this.globalUserId=ht(),this.storage.setItem("globalUserId",this.globalUserId)),this.globalUserId},e.prototype.getGlobalUserIdFromCookie=function(){var t=document.cookie.match("^(?:.*_frvr=([^;]*)).*$");return this.globalUserId=t&&t[1]||ht(),this.refreshUserIdCookie(this.globalUserId),this.globalUserId},e.prototype.refreshUserIdCookie=function(t){var e=new Date;e.setDate(e.getDate()+730),document.cookie="_frvr="+t+"; path=/; expires="+new Date(e).toUTCString()+"; domain="+function(){for(var t=document.location.hostname.split("."),e=t.length-1;e>=0;e--){var n=t.slice(e).join(".");if(document.cookie="get_tld=test;domain=."+n+";",document.cookie.indexOf("get_tld")>-1)return document.cookie="get_tld=;domain=."+n+";expires=Thu, 01 Jan 1970 00:00:01 GMT;",n}return""}()+";"},e}(),pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.setCanUseCookies=function(){this.canUseCookies=!1},e}(lt);function ft(t){function e(){var t,e;return window.innerWidth||(null===(t=document.documentElement)||void 0===t?void 0:t.clientWidth)||(null===(e=document.body)||void 0===e?void 0:e.clientWidth)}function n(){var t,e;return window.innerHeight||(null===(t=document.documentElement)||void 0===t?void 0:t.clientHeight)||(null===(e=document.body)||void 0===e?void 0:e.clientHeight)}var r,i,s=(r=(document.location.search||"").replace(/^\?/,""),{utm_source:(i=function(t){var e=r.match("^(?:.*".concat(t,"=([^&]*)|).*$"));return null==e?void 0:e[1]})("utm_source"),utm_medium:i("utm_medium"),utm_campaign:i("utm_campaign"),utm_term:i("utm_term"),utm_content:i("utm_content")});return function(r){return o(o({},s),{play_session_id:r.getPlaySessionId(),channel:t,device_width:e(),device_height:n()})}}var gt=function(){function e(e,n){this.consentsBitSet=t.ConsentOptions.None,this.legitimateInterestsBitSet=t.ConsentOptions.None,this.consentIsLoaded=!1,this.logger=n,this.onConsentChangedHandlers=[],this.loadConsentManagementPlatform(e)}return e.prototype.tcfDataBitSet2ConsentOptionsBitSet=function(t){var e=0;for(var n in t)t[n]&&(e|=1<<Number(n));return e},e.prototype.onLoad=function(){var t,e=this;if(window.__tcfapi){null===(t=this.logger)||void 0===t||t.log("TcfV2ConsentProvider::onLoad()");window.__tcfapi("addEventListener",2,(function(t,n){var r,o,i;n?"useractioncomplete"!==t.eventStatus&&"tcloaded"!==t.eventStatus||(e.consentIsLoaded=!0,e.consentsBitSet=e.tcfDataBitSet2ConsentOptionsBitSet(null!==(o=t.purpose.consents)&&void 0!==o?o:{}),e.legitimateInterestsBitSet=e.tcfDataBitSet2ConsentOptionsBitSet(null!==(i=t.purpose.legitimateInterests)&&void 0!==i?i:{}),e.dispatchConsentChanged(e.consentsBitSet,e.legitimateInterestsBitSet)):null===(r=e.logger)||void 0===r||r.warn("TcfV2ConsentProvider::onLoad::updateConsentCallback:!success")}))}},e.prototype.dispatchConsentChanged=function(t,e){for(var n=0;n<this.onConsentChangedHandlers.length;n++)this.onConsentChangedHandlers[n](t,e)},e.prototype.hasLoaded=function(){return this.consentIsLoaded},e.prototype.loadConsentManagementPlatform=function(t){var e=this,n=1,r=function(){window.__tcfapi?e.onLoad():(setTimeout(r,n),(n*=2)>4e3&&(n=4e3))};r()},e.prototype.consentToTerms=function(){var t;null===(t=this.logger)||void 0===t||t.warn("TcfV2ConsentProvider::consentToTerms(NoOpImpl)")},e.prototype.onConsentChanged=function(t){this.onConsentChangedHandlers.push(t),this.consentIsLoaded&&t(this.consentsBitSet,this.legitimateInterestsBitSet)},e.prototype.hasConsentForAny=function(e,n){return void 0===n&&(n=t.ConsentOptions.None),this.hasLoaded()&&0!=(this.consentsBitSet&e)},e.prototype.hasConsentForAll=function(e,n){return void 0===n&&(n=t.ConsentOptions.None),this.hasLoaded()&&(this.consentsBitSet&e)==e},e.prototype.consents=function(){return this.consentsBitSet},e.prototype.legitimateInterests=function(){return this.legitimateInterestsBitSet},e}(),vt=function(){function t(t){this.decode(t)}return t.prototype.getRightmost1Index=function(){return this.bits.lastIndexOf("1")},t.prototype.is1AtIndex=function(t){return t>=0&&"1"===this.bits.substr(t,1)},t.prototype.set1AtIndex=function(t){this.bits=this.bits.substr(0,t)+"1"+this.bits.substr(t+1)},t.prototype.decode=function(t){return/^0x[a-f0-9]*$/i.test(t)||(t="0x"+(Number(t)||0).toString(2).split("").reverse().join("").toString()),t=t.substring(2),this.bits=t.split("").map((function(t){for(var e=parseInt(t,16).toString(2);e.length<4;)e="0"+e;return e})).join("")},t.prototype.encode=function(){return"0x"+this.bits.match(/(.{1,4})/g).map((function(t){for(;t.length<4;)t+="0";return parseInt(t,2).toString(16)})).join("")},t}(),mt=function(){function e(){this.PLAY_SESSION_TIMEOUT=18e5,this.randomPageSessionId=ht(),this.randomPlaySessionId=ht(),this.randomGlobalUserId=ht(),this.randomPlaySessionIdTimeStamp=Date.now()}return e.prototype.init=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},e.prototype.getName=function(){return"random"},e.prototype.getUserSource=function(){return t.AnalyticsIDProviderStorageType.IN_MEMORY},e.prototype.getPageSessionId=function(){return this.randomPageSessionId},e.prototype.getPlaySessionId=function(){return this.randomPlaySessionIdTimeStamp+this.PLAY_SESSION_TIMEOUT<Date.now()&&(this.randomPlaySessionId=ht()),this.randomPlaySessionIdTimeStamp=Date.now(),this.randomPlaySessionId},e.prototype.getGlobalUserId=function(){return this.randomGlobalUserId},e}();for(var yt=function(){function e(t){var e=void 0===t?{}:t,n=e.analyticsProviders,r=e.idProvider,o=e.consentProvider,i=e.contextProvider,s=e.storage,a=e.logger;this.ANALYTICS_STORAGE_KEY="__frvr_analytics_storage",this.data={},this.extraFieldFunctions=[],this.MAX_PRE_CONSENT_LOAD_EVENT_QUEUE=100,this.preConsentLoadEventQueue=[],this.randomIdProvider=new mt,this.analyticsProviders=null!=n?n:[],this.idProvider=null!=r?r:ct,this.consentProvider=null!=o?o:new gt,this.storage=null!=s?s:p,this.logger=null!=a?a:c,this.contextProvider=i,this.timeStart=Date.now()}return e.prototype.loadStorage=function(){return s(this,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return t=this,[4,this.storage.getItem(this.ANALYTICS_STORAGE_KEY,{})];case 1:return t.data=e.sent(),[2]}}))}))},e.prototype.updateStorage=function(){this.storage.setItem(this.ANALYTICS_STORAGE_KEY,o({},this.data))},e.prototype.getContextFields=function(){for(var t=this.data.game_start_time,e=o(o(o(o(o({},this.contextProvider(this)),this.getConsentContextFields()),{page_session_id:this.getConsentedIdProvider().getPageSessionId(),play_session_id:this.getConsentedIdProvider().getPlaySessionId()}),this.data),{game_duration:void 0!==t?-1===t?0:Date.now()-t:void 0,loading_time:void 0===this.timeLoaded?void 0:this.timeLoaded-this.timeStart}),n=0,r=this.extraFieldFunctions;n<r.length;n++){(0,r[n])(e)}return e},e.prototype.dispatchOutstandingEvents=function(){for(var t=this.preConsentLoadEventQueue;t.length>0;){var e=t.shift(),n=e.event,r=e.value,i=e.fields,s=e.context,a=e.requiredConsents,u=e.requiredLegitimateInterests;this.dispatchEvent(n,r,i,o(o({},s),this.getConsentContextFields()),a,u)}},e.prototype.dispatchEvent=function(t,e,n,r,o,i){for(var s=0,a=this.analyticsProviders;s<a.length;s++){var u=a[s];try{this.consentProvider.hasConsentForAll(o,i)&&u.send(t,e,n,r)}catch(t){this.logger.error("[frvr-tracker] error sending event via provider ".concat(u.getName()),t)}}},e.prototype.getConsentContextFields=function(){return{cmp_consents:this.consentProvider.consents(),cmp_legitimateInterests:this.consentProvider.legitimateInterests()}},e.prototype.send=function(t,e,n,r,i){var s=this.getContextFields();for(var a in n)void 0===n[a]&&delete n[a];for(var a in s)void 0===s[a]&&delete s[a];this.logger.log("[frvr-tracker] event",t,n,s),this.consentProvider.hasLoaded()?(this.dispatchOutstandingEvents(),this.dispatchEvent(t,e,n,o(o({},s),this.getConsentContextFields()),r,i)):this.preConsentLoadEventQueue.length<this.MAX_PRE_CONSENT_LOAD_EVENT_QUEUE&&this.preConsentLoadEventQueue.push({event:t,value:e,fields:n,context:s,requiredConsents:r,requiredLegitimateInterests:i})},e.prototype.init=function(){return s(this,void 0,void 0,(function(){var e=this;return a(this,(function(n){switch(n.label){case 0:return function(t){var e=window.onerror;window.onerror=function(n,r,o,i,s){if(e)try{e(n,r,o,i,s)}catch(t){}if(n=String(n),s=s||new Error(n))try{t({msg:n,line:o,col:i,label:s.stack||JSON.stringify(s)})}catch(t){}return!1};var n=window.onunhandledrejection?window.onunhandledrejection.bind(window):null;window.onunhandledrejection=function(e){if(n)try{n(e)}catch(t){}try{var r=e&&e.reason||{};t({msg:r.message,line:0,col:0,label:"unhandled_rejection: "+(r.stack||JSON.stringify(r))})}catch(t){}}}((function(n){return e.logEvent("error",n,t.ConsentOptions.None)})),[4,this.loadStorage()];case 1:return n.sent(),[4,Promise.all([this.idProvider.init(),this.randomIdProvider.init()])];case 2:return n.sent(),[4,Promise.all(this.analyticsProviders.map((function(t){return t.init(e.consentProvider,e)})))];case 3:return n.sent(),[2]}}))}))},e.prototype.loaded=function(){this.timeLoaded=Date.now(),this.logEvent("game_loaded",{},t.ConsentOptions.P10DevelopAndImproveProducts)},e.prototype.set=function(t,e){return this.data[t]=e,this.updateStorage(),e},e.prototype.inc=function(t,e){var n=(this.data[t]||0)+(void 0===e?1:e);return this.set(t,n),n},e.prototype.logEvent=function(e,n,r,o){void 0===r&&(r=t.ConsentOptions.None),void 0===o&&(o=t.ConsentOptions.None),this.send(e,void 0,n,r,o)},e.prototype.logValuedEvent=function(e,n,r,o,i){void 0===o&&(o=t.ConsentOptions.None),void 0===i&&(i=t.ConsentOptions.None),this.send(e,n,r,o,i)},e.prototype.logDiscoveryPageView=function(e){this.send("discovery_page_view",void 0,e,t.ConsentOptions.None,t.ConsentOptions.None)},e.prototype.getPlaySessionId=function(){return this.getConsentedIdProvider().getPlaySessionId()},e.prototype.getGlobalUserId=function(){return this.getConsentedIdProvider().getGlobalUserId()},e.prototype.getUserSource=function(){return this.getConsentedIdProvider().getUserSource()},e.prototype.addExtraFieldFunction=function(t){this.extraFieldFunctions.push(t)},e.prototype.ftue=function(e,n,r){var i=new vt(this.data.ftuestepsdone);if(e<=i.getRightmost1Index())this.logger.warn("[frvr-tracker] ftue:","step ".concat(e," (").concat(n,") has already been tracked"));else{i.set1AtIndex(e),this.set("ftuestepsdone",i.encode());var s=o(o({},r),{step_number:e,step_name:n});this.logEvent("ftue",s,t.ConsentOptions.P6PersonalizedContent|t.ConsentOptions.P5PersonalizedContentProfile|t.ConsentOptions.P8MeasureContentPerformance|t.ConsentOptions.P9MarketResearchForAudienceInsights|t.ConsentOptions.P10DevelopAndImproveProducts)}},e.prototype.levelStart=function(e,n){var r=o(o({},n),{level_id:e});this.set("game_start_time",Date.now()),this.inc("games_played");var i,s=(i=new Date).getUTCFullYear()+"-"+dt(i.getUTCMonth()+1)+"-"+dt(i.getUTCDate());this.data.last_day_played!==s&&(this.set("last_day_played",s),this.inc("days_played"));var a=this.inc("play_session_count");this.logValuedEvent("game_play_start",a,r,t.ConsentOptions.P8MeasureContentPerformance|t.ConsentOptions.P10DevelopAndImproveProducts)},e.prototype.levelEnd=function(e,n){var r=o(o({},n),{level_id:e});this.logEvent("game_end",r,t.ConsentOptions.P8MeasureContentPerformance|t.ConsentOptions.P10DevelopAndImproveProducts),this.set("game_start_time",-1)},e.prototype.getConsentedIdProvider=function(){return this.consentProvider.hasConsentForAll(t.ConsentOptions.P1StoreInformationOnADevice,t.ConsentOptions.None)?this.idProvider:this.randomIdProvider},e}(),It=[],Pt=0;64>Pt;)It[Pt]=0|4294967296*Math.abs(Math.sin(++Pt));var St=function(){function t(t){var e=t.tracker,n=t.logger,r=void 0===n?c:n;this.initialized=!1,this.forcedCohorts={},this.abTestCohorts={},this.onInitReadyCbs=[],this.abTestEnabled=!0,this.tracker=e,this.logger=r}return t.prototype.force=function(t,e){this.logger.warn("[frvr-abtest] init: Forcing cohort ".concat(e," for test ").concat(t)),this.forcedCohorts[t]=e},t.prototype.init=function(t){return s(this,void 0,void 0,(function(){var e,n,r,o=this;return a(this,(function(i){if(e=this.tracker.getGlobalUserId(),this.logger.debug("[frvr-abtest] init: Initializing A/B tests with id ".concat(e)),t){for(n in t)t[n].active&&this.addTest(e,n,t[n].cohorts,!1);if(this.logger.debug("[frvr-abtest] init: A/B tests cohorts:",this.abTestCohorts),this.abTestEnabled){for(n in t)t[n].active&&(this.tracker.logValuedEvent("ab_test_activation",1,{ab_test_name:n,ab_test_group:this.abTestCohorts[n]}),this.tracker.logValuedEvent("ab_".concat(n),1,Object.fromEntries(Object.entries(this.abTestCohorts).map((function(t){var e=t[0],n=t[1];return["ab_".concat(e),n]})))));this.tracker.addExtraFieldFunction((function(e){if(o.abTestEnabled)for(var n in t)t[n].active&&(e["abt_".concat(n)]=o.abTestCohorts[n])}))}else this.logger.debug("[frvr-abtest] init: A/B tests disabled.")}else this.logger.debug("[frvr-abtest] init: No A/B tests are defined.");for(this.initialized=!0,r=0;r<this.onInitReadyCbs.length;r++)this.onInitReadyCbs[r]();return[2]}))}))},t.prototype.addTest=function(t,e,n,r){var o,i,s,a,u=this.forcedCohorts[e];return u&&-1==n.indexOf(u)&&this.logger.error("[frvr-abtest] Forced cohort doesn't exist: ".concat(this.forcedCohorts[e],".")+"Valid cohorts are:",n),u||(u=n[(o=t,i=e,s=n.length,a=function(t){for(var e,n,r,o,i=[],s=(t=unescape(encodeURI(t))).length,a=[e=1732584193,n=-271733879,~e,~n],u=0;u<=s;)i[u>>2]|=(t.charCodeAt(u)||128)<<u++%4*8;for(i[t=16*(s+8>>6)+14]=8*s,u=0;u<t;u+=16){for(s=a,o=0;64>o;)s=[r=s[3],(e=0|s[1])+((r=s[0]+[e&(n=s[2])|~e&r,r&e|~r&n,e^n^r,n^(e|~r)][s=o>>4]+(It[o]+(0|i[[o,5*o+1,3*o+5,7*o][s]%16+u])))<<(s=[7,12,17,22,5,9,14,20,4,11,16,23,6,10,15,21][4*s+o++%4])|r>>>32-s),e,n];for(o=4;o;)a[--o]=a[o]+s[o]}for(t="";32>o;)t+=(a[o>>3]>>4*(1^7&o++)&15).toString(16);return t}(i+":"+o).substr(-8),parseInt(a,16)%s)]),this.abTestCohorts[e]=u,r&&this.abTestEnabled&&this.tracker.logValuedEvent("ab_test_activation",1,{ab_test_name:e,ab_test_group:this.abTestCohorts[e]}),{test:e,cohort:u}},t.prototype.cohort=function(t){if(!this.initialized)throw new Error("[frvr-abtest] cohort: Called before initialization!");if(this.abTestEnabled){var e=this.abTestCohorts[t];return void 0===e&&this.logger.error("[frvr-abtest] cohort: No cohort defined for test: ".concat(t)+" - did you misspell your test name? Tests:",this.abTestCohorts),e}},t.prototype.switch=function(t,e){if(!this.abTestEnabled)return{fallback:function(t){t&&t()}};if(!this.initialized)throw new Error("[frvr-abtest] switch: Called before initialization!");var n=this.cohort(t);return n&&e[n]&&e[n](),{fallback:function(){}}},t.prototype.onInitReady=function(t){this.initialized?t():this.onInitReadyCbs.push(t)},t}(),bt={chromeWrapper:"chromeos",androidWrapper:"android",iOSWrapper:"ios",rcs:"rcs",samsungAppStore:"samsung_galaxy_store",facebookInstant:"facebook_instant",facebookRooms:"facebook_rooms",facebookAppWeb:"facebook_canvasweb",facebookApp:"facebook_canvas",samsungBixby:"bixby",samsungGameLauncher:"samsung_game_launcher",samsungInstantPlay:"samsung_instant_play",spilGamesWrapper:"spil",vkru:"vkru",okru:"okru",kik:"kik",twitter:"twitter",twitch:"twitch",hago:"hago",oppoGlobal:"oppo_global",tMobile:"tmobile",huawei:"huawei",huaweiquickapp:"huawei_quick_app",yandex:"yandex",crazyGames:"crazy_games",lgtv:"lg_tv",jioStb:"jio_stb",myJio:"jio_my",jioGameslite:"jio_gameslite",rocketChat:"rocket_chat",ufone:"ufone",game8:"game8",mailonline:"mail_online",discord:"discord",harman:"harman"},Et="frvr",_t={7978894035:"samsung_game_launcher",7640790291:"bixby",3704760038:"legacy_samsung_daily",4056808137:Et,3238562380:"samsung_instant_play",5374938192:Et,5362404538:Et,9165482691:Et,1661744930:Et,1781508157:Et,1526015108:"legacy_samsung_browser_us",9152813246:"legacy_samsung_gl_fallback",1570234097:"bixby",6159024522:"telenorpk",9547456458:"huawei_quick_app",4901070532:Et,5509479103:Et,4687607673:Et,7772201439:Et,5781080938:Et,7859627468:"bixby",6225636036:Et,9257964653:Et,9997971842:"legacy_samsung_gl_pwa",1810535265:Et,6879406107:Et,5664912848:Et,7871893264:"oppo_global",6905222938:"1001spill",1074763396:Et,4822698373:"huawei",3917207338:Et,3091839955:Et,9511672440:Et,9609759920:Et,8846287731:Et,1912410415:Et,3463089052:Et,3138478138:"spil",3609613151:Et,7259516105:Et,8260783143:Et,4791934430:Et,5304245228:Et,4196077731:Et,7517011737:"ga",1420430092:Et,6341560802:Et,3188724532:Et,7430391555:"samsung_galaxy_store_pwa",6142190935:Et,2410146e3:"spil",6238202936:Et,2165771095:Et,7169566203:Et,7116648941:Et,9484119302:Et,8289067739:"crazy_games",4942292965:Et,4111954147:"samsung_instant_daily",9508446909:"mozilla_lite",6581072258:Et,6305391737:Et,7721350107:Et,5689634745:Et,4407671492:Et,8793151713:"mynet",6701854007:Et,8166612510:Et,1204043211:Et,8540348735:Et,8092992494:Et,3050063345:Et,6105016100:Et,5383746593:Et,2155121367:Et,4481639214:Et,9167804042:Et,2633738716:Et,5732840388:Et,1136474154:Et,3868538934:Et,6791411817:Et,4001058104:"spil",8323344707:Et,1511956590:Et,5337609782:Et,7647348124:Et,9465676615:Et,8699389853:Et,8288405339:"ga",1601204168:Et,6738957149:Et,3143968130:"spil",3660984936:"legacy_all_samsung_browser",6672071330:"ga",9944902462:Et,4216099801:"ga",9810477030:Et,4127083129:Et,9831349735:"mediatrust",1651142765:Et,2402315798:Et,3217022605:"rcs",8209630496:Et,7348809119:Et,1907949320:Et,7711130568:Et,6682900564:Et,8220757253:Et,9226003469:Et,6459119768:"ga",3297429215:Et,2066412442:Et,9610826637:"spil",5428378892:Et,3718604937:"ga",7010263033:Et,5533541335:"spil",5393940535:"spil",6680931602:Et,8135642444:Et,5195338130:"ga",2443106993:Et,9841433446:Et,9471076165:"spil",8645981334:"clickjogos",9750454053:"spil",5496116299:"spil",9095657336:"spil",5196972230:Et,1711991335:"spil",1463804937:"plonga",6650691459:Et,7854536931:"spil",4185858062:Et,1559694722:Et,4196397436:"ga",5791200697:Et,8838890658:Et,6592001260:Et,8990371880:"rocketchat",3078524176:Et,1414057592:"spil",1721816412:"spil",7627870781:"samsung_instant_browser_us",7257814137:"spil",6687910134:"mfogs",6388800833:Et,6794212012:"mailonline",2719344539:"spil",6005657456:Et,4761469737:"spil",8260978605:Et,4899645641:Et,5570875049:"tron",3275762232:"spil",1433925895:"spil",7925670440:"taboola",3587369568:"squid",3982547231:Et,4388062450:"spil",8471269857:"bixby",1323020937:"spil",3605255281:"bixby",9085283107:Et,1873844328:"legacy_samsung_browser_m4s",8924310391:"bixby",7269966843:"tmobile",1075554580:"adsenseforgamestest2",1098459098:Et,8199816817:"xiaomi"},wt=window.location.href;var At=function(t,e){var n="frvr";for(var r in bt)t[r]&&(n=bt[r]);var o=e();if(o){var i=_t[o];i&&(n=i)}return(window.location&&window.location.host&&"krunker.io"===window.location.host||"internal.krunker.io"===window.location.host)&&(n="krunker_io"),n},Ct=function(t,e){null!=t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)","i").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},Tt=function(t,e){return function(n,r,o,i){var s,a={};return t&&(a[t]=!0),a.android=/(android)/i.test(o)&&!/(Windows)/i.test(o),a.androidVersion=(s=navigator.userAgent.toLowerCase().match(/android\s([0-9\.]*)/),parseFloat(s?s[1]:"0")),a.firefoxMobile=/(Mobile)/i.test(o)&&/(Firefox)/i.test(o),a.slow=a.android&&a.androidVersion<6,a.iOS=/(ipod|iphone|ipad)/i.test(o)||/(Macintosh)/i.test(o)&&"ontouchend"in document,a.windowsMobile=/(IEMobile)/i.test(o),a.silk=/(silk)/i.test(o),a.clay=/(clay\.io)/i.test(i),a.facebookApp=/(fb_canvas)/i.test(i),a.facebookAppWeb=/(fb_canvas_web)/i.test(i),a.iframed=n.top!==n.self,a.standalone="standalone"in r&&r.standalone,a.mobileiOSDevice=Boolean(o.match(/iPhone/i)||o.match(/iPod/i)),a.kongregate=/(kongregateiframe)/i.test(i),a.kik=/(kik_canvas)/i.test(i),a.twitter=/(twitter)/gi.test(o),a.chrome=/Chrome\//.test(o),a.safari=!!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/),a.secureConnection=0==window.location.protocol.indexOf("https"),a.facebookInstant=!!window.FBInstant,a.facebookRooms=!!window.isFacebookRooms,a.spilGamesWrapper=/(spilgames)/i.test(i),a.social="on"==Ct(e,"social"),a.advertisementIsDisabled="off"==Ct(e,"ads"),a.advertisementInterstitialDisabled="off"==Ct(e,"int"),a.advertisementOverlayEnabled=!a.iframed||a.spilGamesWrapper||Boolean(Ct(e,"partnerid")),a.nosoc="1"==Ct(e,"nosoc"),a.facebookAd=/(\/\?fb)/i.test(i),a.mobile=a.android||a.windowsMobile||a.iOS||a.silk||a.firefoxMobile,a.iOSWrapper=!!n.iOSWrapper,a.iPhoneXOrLater="true"==Ct(e,"iPhoneXOrLater"),a.iMessageContext="true"==Ct(e,"iMessage"),a.androidWrapper=!!n.androidWrapper,a.chromeWrapper=!!n.isChromeWrapper,a.samsungAppStore="samsung"==Ct(e,"androidStore"),a.appWrapper=Boolean(n.iOSWrapper||n.androidWrapper||a.samsungAppStore),a.usingWebGLRenderer=!1,a.usingCanvasRenderer=!1,a.jioStb=!!a["jio-stb"],a.myJio=!!a.myjio,a.jioGameslite=!!a["jio-gameslite"],a.jio=a.jioStb||a.myJio||a.jioGameslite,a.twitch=""==Ct(e,"twitch"),a.vkru=""==Ct(e,"vkru"),a.okru=""==Ct(e,"okru"),a.tMobile=""==Ct(e,"tmobile"),a.pwa=""==Ct(e,"pwa"),a.windowsApp=""==Ct(e,"windowsapp"),a.enableAppStoreLinks=!0,a.samsungGalaxyStorePWA=""==Ct(e,"samsung")&&"galaxystore"==Ct(e,"source"),a.samsungGameLauncherPWA=(""==Ct(e,"pwa")||""==Ct(e,"samsung"))&&"gamelauncher"==Ct(e,"source"),a.samsungGameLauncher=!!window.FRVRInstant||(""==Ct(e,"gamelauncher")||"gamelauncher"==Ct(e,"source")),a.samsungBixby=""==Ct(e,"samsung")&&!a.samsungGalaxyStorePWA,a.samsungBrowserUK=""==Ct(e,"samsungbuk"),a.samsungBrowserUS=""==Ct(e,"samsungbus"),a.samsungBrowserSEA=""==Ct(e,"samsungbsea"),a.samsungBrowser=""==Ct(e,"samsungbrowser"),a.samsungGLFallback=""==Ct(e,"gl_fallback"),a.samsungInstantPlay=!!window.GSInstant,a.samsung=a.samsungGalaxyStorePWA||a.samsungGameLauncherPWA||a.samsungGameLauncher||a.samsungBixby||a.samsungBrowserUK||a.samsungBrowserUK||a.samsungBrowserUS||a.samsungBrowserSEA||a.samsungBrowser||a.samsungGLFallback||a.samsungInstantPlay,a.rcs=Boolean(Ct(e,"rcsid")),a.rcsKr=""==Ct(e,"rcskr"),a.huaweiquickapp=""==Ct(e,"huaweiquickapp"),a.huawei=""==Ct(e,"huawei")||a.huaweiquickapp,a.mozilla=""==Ct(e,"mozilla"),a.miniclip=""==Ct(e,"miniclip"),a.chromeOSDevice="true"==Ct(e,"isChromeOSDevice"),a.opera=!!n.opr&&!!n.opr.addons||!!n.opera||o.indexOf(" OPR/")>=0,a.yandex=!!window.YaGames,a.firefox=void 0!==n.InstallTrigger,a.edge=/(edge|edgios|edga)\/((\d+)?[\w\.]+)/i.test(o),a.oppoGlobal=""==Ct(e,"oppo"),a.lgtv=""==Ct(e,"lgtv"),a.crazyGames="8289067739"==Ct(e,"partnerid"),a.mynet=""==Ct(e,"mynet"),a.ufone="8416254215"==Ct(e,"partnerid"),a.game8=""==Ct(e,"game8"),a.mailonline="6794212012"==Ct(e,"partnerid"),a.disableNativeBridge=""==Ct(e,"disableNativeBridge"),a.partnerWrapper=!a.disableNativeBridge&&(a.mynet||a.tMobile||a.ufone||a.mailonline)&&(a.iOS||a.android),a.rocketChat=""==Ct(e,"rocketchat"),a.discord="discord"===t,a.harman=""==Ct(e,"harman"),a.progressiveWebAppEnabled=!(a.chromeOSDevice||a.iframed||a.appWrapper||a.twitch||a.vkru||a.okru||a.facebookInstant||a.partnerWrapper),a.tv=a.jioStb||a.lgTV,a}(window,navigator,navigator.userAgent,String(window.location))};var Rt,kt,Ot,Nt,Lt,Ft,Dt={getChannel:(Rt="",kt={},function(){if(Nt)return Nt;var t,e,n;null!=Lt||(Lt=Tt(Rt,wt)),null!=Ot||(t=wt,e=Lt,n=kt||{},Ot=function(){return function(t,e,n){var r=Ct(t,"partnerid");if(r)return r;for(var o=0,i=[["samsungBrowser","3660984936"],["rcs","3217022605"],["huaweiquickapp","9547456458"],["huawei","4822698373"],["tMobile","7269966843"],["miniclip","8532226134"],["samsungBrowserSEA","2765561693"],["samsungBrowserUS","1526015108"],["samsungBrowserUK","2961002817"],["mozilla","9508446909"],["samsungBixby","7640790291"],["samsungGalaxyStorePWA","7430391555"],["samsungGameLauncherPWA","9997971842"],["samsungInstantPlay","3238562380"]];o<i.length;o++){var s=i[o],a=s[0],u=s[1];if(e[a])return u}var c={ft_daily:"4111954147",ft_bixby:"7859627468",ft_browser_us:"7627870781",ft_browser_uk:"8436188448",default:"7978894035"},d={ft_daily:"3704760038",ft_bixby:"7640790291",ft_browser_us:"1526015108",ft_browser_uk:"2961002817",default:"9152813246"};return e.samsungGameLauncher?c[Ct(t,"source")]||c.default:Ct(t,"gl_fallback")||""===Ct(t,"gl_fallback")?d[Ct(t,"source")]||d.default:e.spilGamesWrapper&&n.googleAdSpilgamesId?n.googleAdSpilgamesId:!!n.googleAdSiteId&&n.googleAdSiteId}(t,e,n)});var r=At(Lt,Ot);return Nt=r,r})},Ut={getName:function(){return"Empty Provider"},init:function(){return s(void 0,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},configure:function(){return s(void 0,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},isReady:function(){return!1},getCatalog:function(){return{}},getProductById:function(){},purchase:function(){return s(void 0,void 0,void 0,(function(){return a(this,(function(t){throw new Error("no products")}))}))},consumePurchase:function(){throw new Error("no products")},getUnconsumedPurchases:function(){return s(void 0,void 0,void 0,(function(){return a(this,(function(t){return[2,[]]}))}))}},Vt={logEvent:function(){},logValuedEvent:function(){}},Mt=function(){function t(t,e){this.analytics=t,this.providerName=e}return t.prototype.logRequestPaymentError=function(t,e){this.analytics.logValuedEvent("iap_request_payment_failed",1,o(o({},t),{err:e}))},t.prototype.logRequestPaymentSuccess=function(t,e){this.analytics.logValuedEvent("iap_request_payment_success",1,o(o({},t),{purchaseId:e.purchaseId}))},t.prototype.logRequestPayment=function(t){this.analytics.logValuedEvent("iap_request_payment",1,o({},t))},t.prototype.logConsumePurchase=function(t,e){this.analytics.logValuedEvent("iap_consume_purchase",1,o(o({},t),{purchaseId:e.purchaseId}))},t.prototype.logRestorePurchasesError=function(t){this.analytics.logValuedEvent("iap_request_restore_purchase_error",1,{provider:this.providerName,err:t})},t.prototype.logRestorePurchasesSuccess=function(){this.analytics.logValuedEvent("iap_request_restore_purchase_success",1,{provider:this.providerName})},t.prototype.logRestorePurchases=function(){this.analytics.logValuedEvent("iap_request_restore_purchase",1,{provider:this.providerName})},t}();t.IAPErrorCode=void 0,(Ft=t.IAPErrorCode||(t.IAPErrorCode={})).UNKNOWN="UNKNOWN",Ft.USER_INPUT="USER_INPUT",Ft.INVALID_PARAM="INVALID_PARAM";var xt=function(e){function r(n,o,i){void 0===i&&(i=t.IAPErrorCode.UNKNOWN);var s=e.call(this,n,o)||this;return s.code=i,Object.setPrototypeOf(s,r.prototype),s}return n(r,e),r}(Error),Bt=function(e){function r(n,o){var i=e.call(this,n,o,t.IAPErrorCode.INVALID_PARAM)||this;return Object.setPrototypeOf(i,r.prototype),i}return n(r,e),r}(xt),jt=function(e){function r(n,o){void 0===n&&(n="Purchase cancelled by user");var i=e.call(this,n,o,t.IAPErrorCode.USER_INPUT)||this;return Object.setPrototypeOf(i,r.prototype),i}return n(r,e),r}(xt),Gt=Object.freeze({__proto__:null,get IAPErrorCode(){return t.IAPErrorCode},IAPError:xt,IAPPurchaseErrorUnknownProduct:Bt,IAPPurchaseErrorCancelledByUser:jt}),Wt=function(){function t(t){this.errors=Gt,this.provider=t.provider||Ut,this.iapTracker=new Mt(t.tracker||Vt,this.provider.getName()),this.logger=t.logger||c}return t.prototype.init=function(){return this.provider.init()},t.prototype.configure=function(t){return this.provider.configure(t)},t.prototype.isReady=function(){return this.provider.isReady()},t.prototype.getCatalog=function(){return this.provider.getCatalog()},t.prototype.getProductById=function(t){var e=this.provider.getProductById(t);if(e)return o(o({},e),{provider:this.provider.getName(),productId:t});this.logger.error("IAP. Product not found",t)},t.prototype.purchase=function(t,e){return s(this,void 0,void 0,(function(){var n,r,o,i;return a(this,(function(s){switch(s.label){case 0:if(n=this.getProductById(t),this.iapTracker.logRequestPayment(n),!n)throw new Bt('Unknown product "'.concat(t,'"'));s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.provider.purchase(t,e)];case 2:return r=s.sent(),this.iapTracker.logRequestPaymentSuccess(n,r),[2,r];case 3:if(o=s.sent(),i=o.message||o.toString(),this.iapTracker.logRequestPaymentError(n,i),o instanceof jt)throw this.logger.log("Purchase cancelled by user"),o;throw this.logger.error("Error in purchase: "+i,o),new xt("Unexpected purchase error",{cause:o});case 4:return[2]}}))}))},t.prototype.consumePurchase=function(t){return s(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:e=this.getProductById(t.productId),this.iapTracker.logConsumePurchase(e,t),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.provider.consumePurchase(t)];case 2:return r.sent(),[3,4];case 3:throw n=r.sent(),new xt("Unexpected consume error",{cause:n});case 4:return[2,t.purchaseId]}}))}))},t.prototype.getUnconsumedPurchases=function(){return s(this,void 0,void 0,(function(){var t,e,n;return a(this,(function(r){switch(r.label){case 0:this.iapTracker.logRestorePurchases(),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.provider.getUnconsumedPurchases()];case 2:return t=r.sent(),this.iapTracker.logRestorePurchasesSuccess(),[2,t];case 3:return e=r.sent(),n=e.message||e.toString(),this.iapTracker.logRestorePurchasesError(n),this.logger.error("Error in getUnconsumedPurchases: "+n,e),[3,4];case 4:return[2,[]]}}))}))},t.prototype.requestPayment=function(t,e){return this.purchase(t,e)},t.prototype.restorePurchases=function(){return this.getUnconsumedPurchases()},t.prototype.getPurchases=function(){return this.getUnconsumedPurchases()},t}(),Ht=function(){function t(){this.catalog=null,this.nextPurchaseId=0,this.purchasesNotConsumed={}}return t.prototype.getName=function(){return"MockIAP"},t.prototype.init=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},t.prototype.configure=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){return this.catalog=null==t?void 0:t.catalog,[2]}))}))},t.prototype.isReady=function(){return null!=this.catalog},t.prototype.getCatalog=function(){var t;return null!==(t=this.catalog)&&void 0!==t?t:{}},t.prototype.getProductById=function(t){var e;if(!this.catalog)return null;var n=null===(e=this.catalog[t])||void 0===e?void 0:e.label;return n?{trackingName:n,priceValue:"10",currencyCode:"USD",label:"".concat(t," USD 10")}:null},t.prototype.purchase=function(t,e){return s(this,void 0,void 0,(function(){var n;return a(this,(function(r){if(!this.catalog)throw new Error("IAP Not ready");if(null==e?void 0:e.cancelled)throw new jt;if(!window.confirm("[".concat(this.getName(),"] Confirm purchase?")))throw new Error("Purchase cancelled");return n=(++this.nextPurchaseId).toString(),this.purchasesNotConsumed[n]=t,[2,{productId:t,purchaseId:n,channelId:"test",transactionReceipt:"receipt"}]}))}))},t.prototype.consumePurchase=function(t){return this.catalog?(window.console.log("[".concat(this.getName(),"] Purchase consumed:"),t),delete this.purchasesNotConsumed[t.purchaseId],Promise.resolve()):Promise.reject(new Error("IAP Not ready"))},t.prototype.getUnconsumedPurchases=function(){if(!this.catalog)return Promise.reject(new Error("IAP Not ready"));window.console.log("[".concat(this.getName(),"] Purchases restored"));for(var t=[],e=0,n=Object.entries(this.purchasesNotConsumed);e<n.length;e++){var r=n[e],o=r[0],i=r[1];t.push({productId:i,purchaseId:o,channelId:"test",transactionReceipt:"receipt"})}return Promise.resolve(t)},t}(),Kt=function(){function t(){}return t.prototype.scheduleMessage=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,fetch("https://hermes.frvr.com/v1/scheduler",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})];case 1:return[4,e.sent().json()];case 2:return[2,e.sent()]}}))}))},t}(),qt={logEvent:function(){}},Yt=function(){function t(t){var e=t.provider,n=t.logger,r=t.tracker,o=void 0===r?qt:r;this.initialized=!1,this.provider=e,this.logger=n,this.chatbot=new Kt,this.tracker=o}return t.prototype.init=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return this.game?(this.initialized=!0,[2]):(this.logger.error("Notifications class should be configured before it is initialized"),[2])}))}))},t.prototype.configure=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){return this.game=t.game,[2]}))}))},t.prototype.scheduleMessage=function(t){return s(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:if(!this.initialized)throw this.logger.error("Chatbot can not be used until it has been initialized"),new Error("INVALID_OPERATION");return e={game:this.game,platform:this.provider.getName(),player_id:t.playerId,timetorun:t.delayInSeconds,template:{image_url:t.imageUrl,message:t.message,buttons:t.buttons}},[4,this.chatbot.scheduleMessage(e)];case 1:return[2,n.sent()]}}))}))},t.prototype.canScheduleMessages=function(){return this.provider.canScheduleMessages()},t.prototype.subscribeScheduleMessages=function(){var t=this;return this.tracker.logEvent("bot_subscribe_show",{}),this.provider.subscribeScheduleMessages().then((function(e){return e?t.tracker.logEvent("bot_subscribe_success",{}):t.tracker.logEvent("bot_subscribe_failure",{}),e})).catch((function(e){return t.tracker.logEvent("bot_subscribe_failure",{}),!1}))},t.prototype.scheduleLocalNotification=function(t,e,n,r){return this.provider.scheduleLocalNotification(t,e,n,r)},t}();function zt(){this.code="INVALID_OPERATION",this.message="Trying to use an empty interface."}var Jt={getName:function(){return""},canScheduleMessages:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2,!1]}))}))},subscribeScheduleMessages:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2,!1]}))}))},scheduleLocalNotification:function(){return Promise.reject(new zt)}},Qt=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scriptIsLoaded=!1,r}return n(e,t),e.prototype.loadConsentManagementPlatform=function(e){var n=this,r=document.createElement("script");r.type="text/javascript",r.src="https://cookie-cdn.cookiepro.com/scripttemplates/otSDKStub.js",r.setAttribute("data-domain-script",e.websiteKey),r.async=!0,r.defer=!0,r.onload=function(){n.scriptIsLoaded||(n.scriptIsLoaded=!0,t.prototype.loadConsentManagementPlatform.call(n,e))},document.head.appendChild(r);var o=document.createElement("script");r.type="text/javascript",o.innerHTML="function OptanonWrapper() { }",document.head.appendChild(o)},e.prototype.consentToTerms=function(){},e}(gt),Xt=function(){function t(t){var e=t.provider,n=t.logger;this.provider=e,this.logger=n}return t.prototype.init=function(t){this.gameId=t,this.provider.init(t)},t.prototype.create=function(t,e,n){return this.provider.create(t,e,n)},t.prototype.getCurrentTournament=function(t,e){return this.provider.getCurrentTournament(t,e)},t.prototype.getActiveTournaments=function(t,e){return this.provider.getActiveTournaments(t,e)},t.prototype.postScore=function(t,e,n){return this.provider.postScore(t,e,n)},t.prototype.share=function(t,e){return this.provider.share(t,e)},t.prototype.join=function(t){return this.provider.join(t)},t.prototype.getMyEntry=function(t){return this.provider.getMyEntry(t)},t.prototype.getTournamentById=function(t,e,n){return this.provider.getTournamentById(t,e,n)},t.prototype.getAllTournamentIds=function(){return this.provider.getAllTournamentIds()},t.prototype.leave=function(){return this.provider.leave()},t.prototype.isSupported=function(){return this.provider.isSupported()},t.prototype.invitePlayers=function(t){return this.provider.invitePlayers(t)},t}(),$t={init:function(){},getCurrentTournament:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2,null]}))}))},create:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2,""]}))}))},postScore:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},share:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},getActiveTournaments:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2,null]}))}))},join:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},getMyEntry:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},getTournamentById:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},getAllTournamentIds:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2,null]}))}))},leave:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},invitePlayers:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},isSupported:function(){return!1}},Zt=function(){function t(t){var e=t.logger,n=t.provider;this.logger=e,this.provider=n}return t.prototype.init=function(t,e){return s(this,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return this.gameId=t,[4,this.provider.init(t,this.logger,e)];case 1:return[2,n.sent()]}}))}))},t.prototype.create=function(t,e){return this.provider.create(t,e)},t.prototype.challengeByContextId=function(t,e,n){return this.provider.challengeByContextId(t,e,n)},t.prototype.challengeByPlayerId=function(t,e,n){return this.provider.challengeByPlayerId(t,e,n)},t.prototype.getPossibleOpponents=function(){return this.provider.getPossibleOpponents()},t.prototype.getCurrentChallengeId=function(){return this.provider.getCurrentChallengeId()},t.prototype.getCurrentChallengeData=function(){return this.provider.getCurrentChallengeData()},t.prototype.leave=function(){return this.provider.leave()},t.prototype.getAllChallenges=function(t,e){return this.provider.getAllChallenges(t,e)},t.prototype.postScore=function(t){var e=t.score,n=t.challengeId,r=t.name,o=t.photo,i=t.playerId;return this.provider.postScore({score:e,challengeId:n,name:r,photo:o,playerId:i})},t.prototype.join=function(t){return this.provider.join(t)},t.prototype.nudge=function(t,e){return this.provider.nudge(t,e)},t.prototype.getOpponentsFromChallenges=function(t){return this.provider.getOpponentsFromChallenges(t)},t.prototype.getChallengesByOpponents=function(){return this.provider.getChallengesByOpponents()},t.prototype.getEntryPayload=function(){return this.provider.getEntryPayload()},t.prototype.isSupported=function(){return this.provider.isSupported()},t}(),te={init:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},create:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2,""]}))}))},challengeByPlayerId:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2,""]}))}))},getPossibleOpponents:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2,[]]}))}))},challengeByContextId:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2,""]}))}))},getCurrentChallengeData:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},leave:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},getCurrentChallengeId:function(){return""},getAllChallenges:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},postScore:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},join:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},nudge:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},getOpponentsFromChallenges:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},getChallengesByOpponents:function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},getEntryPayload:function(){return{}},isSupported:function(){return!1}},ee={registrationSuccess:"registrationSuccess",registrationConflict:"registrationConflict",loginSuccess:"loginSuccess",accountNotActive:"accountNotActive",invalidCredentials:"invalidCredentials",invalidFormat:"invalidFormat",serverError:"serverError",unknownError:"unknownError",networkError:"networkError",operationSuccess:"operationSuccess",tokenExpired:"tokenExpired",notLoggedIn:"notLoggedIn",platformNotAvailable:"platformNotAvailable",platformLoginFail:"platformLoginFail,"},ne={REG_SUCCESS:{type:ee.registrationSuccess,success:!0,message:"User registered successfully. Pending confirmation"},LOGIN_SUCCESS:{type:ee.loginSuccess,success:!0,message:"Login successful"},OPERATION_SUCCESS:{type:ee.operationSuccess,success:!0,message:"Operation success"},REG_CONFLICT:{type:ee.registrationConflict,success:!1,message:"Email already registered"},ACCOUNT_NOT_ACTIVE:{type:ee.accountNotActive,success:!1,message:"Provided credentials are valid but account is either not confirmed or suspended"},INVALID_CREDENTIALS:{type:ee.invalidCredentials,success:!1,message:"Provided credentials are invalid"},INVALID_FORMAT:{type:ee.invalidFormat,success:!1,message:"Invalid format on data"},SERVER_ERROR:{type:ee.serverError,success:!1,message:"Error on server"},UNKNOWN_ERROR:{type:ee.unknownError,success:!1,message:"Unknown error"},NETWORK_ERROR:{type:ee.networkError,success:!1,message:"Network Error"},TOKEN_EXPIRED:{type:ee.tokenExpired,success:!1,message:"Token has expired. Request a new challenge to get a fresh one"},NOT_LOGGED_IN:{type:ee.notLoggedIn,success:!1,message:"Cannot perform operation without active login"},PLATFORM_NOT_AVAILABLE:{type:ee.platformNotAvailable,success:!1,message:"The requested platform is not available"},PLATFORM_LOGIN_FAIL:{type:ee.platformLoginFail,success:!1,message:"The login on the requested platform failed"}},re=Object.freeze({__proto__:null,RESPONSE_TYPES:ee,default:ee,RESPONSE_DEFINITIONS:ne});function oe(t){if(!t)return null;var e=t.split(".");if(3!=e.length)return null;var n=e[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(window.atob(n).split("").map((function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(r)}var ie,se=function(){function t(t,e){this.refreshToken=e,this.accessToken=t}return Object.defineProperty(t.prototype,"accessToken",{get:function(){return this._accessToken},set:function(t){var e;this._accessToken=t;var n=oe(t);n?(this._accessExpiration=parseInt(null==n?void 0:n.exp,10)||0,this._accessIAT=parseInt(null==n?void 0:n.iat,10)||0,this._verified=!(!1===(null===(e=null==n?void 0:n.extra)||void 0===e?void 0:e.verified))):(this._accessExpiration=0,this._accessIAT=0,this._verified=!1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"refreshToken",{get:function(){return this._refreshToken},set:function(t){var e;if(this._refreshToken=t,t){var n=oe(t);this._refreshExpiration=parseInt(null==n?void 0:n.exp,10),this._platform=null===(e=null==n?void 0:n.extra)||void 0===e?void 0:e.platform,this._frvrID=null==n?void 0:n.sub}else this._refreshExpiration=0,this._platform=null,this._frvrID=null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"accessExpiration",{get:function(){return this._accessExpiration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"refreshExpiration",{get:function(){return this._refreshExpiration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"platform",{get:function(){return this._platform},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frvrID",{get:function(){return this._frvrID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVerified",{get:function(){return this._verified},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"accessIssuedAt",{get:function(){return this._accessIAT},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeTillAccessExpiry",{get:function(){return this.accessToken?Math.floor(this._accessExpiration-Date.now()/1e3):-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"accessLifespan",{get:function(){return this.accessToken?this._accessExpiration-this._accessIAT:0},enumerable:!1,configurable:!0}),t.prototype.updateTokens=function(t,e){this.accessToken=t,this.refreshToken=e},t.prototype.updateTokensIfValid=function(t,e){var n=this.accessToken,r=this.refreshToken;this.updateTokens(t,e),this.isAccessValid()&&this.isRefreshValid()||(this.accessToken=n,this.refreshToken=r)},t.prototype.isAccessValid=function(){return!!this._accessToken&&1e3*(this._accessExpiration-60)>Date.now()},t.prototype.isRefreshValid=function(){return!!this._refreshToken&&1e3*(this._refreshExpiration-60)>Date.now()},t.prototype.isAnyValid=function(){return this.isRefreshValid()||this.isAccessValid()},t.prototype.shouldRefresh=function(){return this.isRefreshValid()&&!this.isAccessValid()},t}(),ae="__FRVR_auth_refresh_token",ue="__FRVR_auth_access_token",ce=function(){function t(){this._currentPair=new se,this.pairsPerPlatform={}}return t.prototype.initFromStorage=function(t){return void 0===t&&(t=p),s(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:return this.storage=t,[4,this.storage.getItem(ae)];case 1:return e=r.sent(),[4,this.storage.getItem(ue)];case 2:return n=r.sent(),this.currentPair=new se(n,e),[2]}}))}))},t.prototype.getAccessToken=function(){return this.currentPair.accessToken},t.prototype.getRefreshToken=function(){return this.currentPair.refreshToken},t.prototype.getFRVRID=function(){return this.currentPair.frvrID},t.prototype.isVerified=function(){return this.currentPair.isVerified},t.prototype.shouldRefresh=function(){return this.currentPair.shouldRefresh()},t.prototype.getCurrentPlatform=function(){return this.currentPair.platform},t.prototype.getAvailablePlatforms=function(){var t=[];for(var e in this.pairsPerPlatform)this.pairsPerPlatform[e].isAnyValid()&&t.push(e);return t},Object.defineProperty(t.prototype,"availableTokens",{get:function(){return this.pairsPerPlatform},enumerable:!1,configurable:!0}),t.prototype.setAsCurrent=function(t){this.currentPair=t,this.storage.setItem(ae,t.refreshToken),this.storage.setItem(ue,t.accessToken)},t.prototype.addPairAsCurrent=function(t,e){var n=new se(t,e);this.setAsCurrent(n)},t.prototype.updateCurrentPair=function(t,e){this.setAsCurrent(new se(t,e))},t.prototype.updateAndValidateCurrentPair=function(t,e){return this.updateCurrentPair(t,e),this.isAccessValid()},t.prototype.deleteTokens=function(){this.currentPair=new se,this.pairsPerPlatform={},this.storage.removeItems([ae,ue])},t.prototype.isAccessValid=function(){return this.currentPair.isAccessValid()},t.prototype.isRefreshValid=function(){return this.currentPair.isRefreshValid()},t.prototype.isAnyValid=function(){return this.currentPair.isAnyValid()},Object.defineProperty(t.prototype,"currentPair",{get:function(){return this._currentPair},set:function(t){this._currentPair=t,(null==t?void 0:t.platform)&&(this.pairsPerPlatform[t.platform]=t)},enumerable:!1,configurable:!0}),t}();!function(t){t.FRVR="frvr",t.FACEBOOK_INSTANT="facebook-instant",t.FACEBOOK_SDK="facebook-web",t.GOOGLE_INTERNAL="google-internal",t.SAMSUNG_INSTANT="samsung-instant",t.APPLE="apple"}(ie||(ie={}));var de={method:"POST",path:"/register"},he={method:"POST",path:"/login"},le={method:"POST",path:"/refresh"},pe={method:"POST",path:"/recover-challenge"},fe={method:"POST",path:"/verify-challenge"},ge={method:"POST",path:"/settings"},ve={method:"GET",path:"/user/verified"},me=function(){function e(e){var n;void 0===e&&(e={}),this.apiBaseURL=(null===(n=e.config)||void 0===n?void 0:n.overrideBackendURL)||(e.env==t.Env.PRODUCTION?"https://crucible.frvr.com/v1/auth":"https://staging.crucible.frvr.com/v1/auth")}return e.prototype.isLoggingIn=function(){return!!this.ongoingFRVRLogin},e.prototype.register=function(t){return s(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){return e={platform:ie.FRVR,credentials:t},n={201:function(){return ne.REG_SUCCESS},409:function(){throw ne.REG_CONFLICT}},[2,this.fetchAndHandleCommonErrors(de,n,e)]}))}))},e.prototype.login=function(t){return s(this,void 0,void 0,(function(){var e,n=this;return a(this,(function(r){return this.ongoingFRVRLogin?[2,this.ongoingFRVRLogin]:(e={201:function(t){return s(n,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:return[4,t.json()];case 1:if(e=r.sent(),(n=new se(e.accessToken,e.refreshToken)).isAccessValid())return[2,o(o({},ne.LOGIN_SUCCESS),{tokenPair:n})];throw ne.SERVER_ERROR}}))}))},401:function(){throw ne.INVALID_CREDENTIALS},403:function(){throw ne.ACCOUNT_NOT_ACTIVE}},this.ongoingFRVRLogin=this.fetchAndHandleCommonErrors(he,e,t),[2,this.ongoingFRVRLogin.finally((function(){n.ongoingFRVRLogin=null}))])}))}))},e.prototype.checkVerification=function(t){return s(this,void 0,void 0,(function(){var e,n=this;return a(this,(function(r){return e={200:function(t){return s(n,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return[4,t.json()];case 1:return[2,null==(e=n.sent())?void 0:e.verified]}}))}))}},[2,this.fetchAndHandleCommonErrors(ve,e,null,{"X-REFRESH-TOKEN":t.refreshToken})]}))}))},e.prototype.initiateVerifyChallenge=function(t){return s(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){return e={platform:ie.FRVR,credentials:t},n={201:function(){return ne.OPERATION_SUCCESS},401:function(){throw ne.INVALID_CREDENTIALS}},[2,this.fetchAndHandleCommonErrors(fe,n,e)]}))}))},e.prototype.initiateRecoveryChallenge=function(t){return s(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){return e={platform:ie.FRVR,credentials:t},n={201:function(){return ne.OPERATION_SUCCESS},401:function(){throw ne.INVALID_CREDENTIALS}},[2,this.fetchAndHandleCommonErrors(pe,n,e)]}))}))},e.prototype.changePassword=function(t,e){return s(this,void 0,void 0,(function(){var n,r;return a(this,(function(o){return n={platform:ie.FRVR,credentials:{newPassword:e}},r={200:function(){return ne.OPERATION_SUCCESS},401:function(){throw ne.INVALID_CREDENTIALS}},[2,this.fetchAndHandleCommonErrors(ge,r,n,{Authorization:"Bearer ".concat(t)})]}))}))},e.prototype.refreshTokens=function(t){return s(this,void 0,void 0,(function(){var e=this;return a(this,(function(n){return[2,this.fetchAndHandleCommonErrors(le,{201:function(n){return s(e,void 0,void 0,(function(){var e;return a(this,(function(r){switch(r.label){case 0:return[4,n.json()];case 1:if(e=r.sent(),t.updateTokensIfValid(e.accessToken,e.refreshToken),t.isAccessValid())return[2,ne.OPERATION_SUCCESS];throw ne.SERVER_ERROR}}))}))},401:function(){throw ne.INVALID_CREDENTIALS}},{refreshToken:t.refreshToken})]}))}))},e.prototype.fetchAndHandleCommonErrors=function(t,e,n,r){return void 0===n&&(n={}),void 0===r&&(r={}),s(this,void 0,void 0,(function(){var i,s,u,c,d,h;return a(this,(function(a){switch(a.label){case 0:i=t.path,s=t.method,u=this.apiBaseURL+i,c={method:s,headers:o({"Content-Type":"application/json"},r),body:n&&JSON.stringify(n)},a.label=1;case 1:return a.trys.push([1,3,,4]),[4,fetch(u,c)];case 2:return d=a.sent(),[3,4];case 3:throw h=a.sent(),o(o({},ne.NETWORK_ERROR),{payload:{error:h}});case 4:if(!d)throw ne.NETWORK_ERROR;if(e[d.status])return[2,e[d.status](d)];switch(d.status){case 400:throw ne.INVALID_FORMAT;case 500:throw ne.SERVER_ERROR;default:throw o(o({},ne.UNKNOWN_ERROR),{payload:{status:d.status,url:t}})}}}))}))},e}(),ye=function(){function t(t){var e,n,r,o;void 0===t&&(t={}),this.loginStatusListeners=[],this.proactiveRefreshTimeoutID=-1,this.logger=t.logger,this.providers=null!==(e=t.providers)&&void 0!==e?e:[],this.storage=null!==(n=t.storage)&&void 0!==n?n:p,this.serviceClient=null!==(r=t.serviceClient)&&void 0!==r?r:new me(t),this.tokenHandler=null!==(o=t.tokenHandler)&&void 0!==o?o:new ce,this._isFRVRLoginEnabled=!this.providers.find((function(t){return t.prohibitsLoginWithFRVRCredentials()}))}return t.prototype.init=function(){return s(this,void 0,void 0,(function(){var t,e,n,r,o,i,s=this;return a(this,(function(u){switch(u.label){case 0:return[4,this.tokenHandler.initFromStorage(this.storage)];case 1:u.sent(),t=!1,e=function(e){return a(this,(function(r){switch(r.label){case 0:return[4,e.init()];case 1:return r.sent(),e.getCredentials()&&!t&&(t=!0,n.loginWithProvider(e).catch((function(t){var n;null===(n=s.logger)||void 0===n||n.warn("Auto login with platform ".concat(e.getPlatformId," failed!"),t)}))),[2]}}))},n=this,r=0,o=this.providers,u.label=2;case 2:return r<o.length?(i=o[r],[5,e(i)]):[3,5];case 3:u.sent(),u.label=4;case 4:return r++,[3,2];case 5:return!t&&this.isLoggedIn()&&this.onLoginStatusChange(),[2]}}))}))},t.prototype.getAccessToken=function(){return this.shouldRefreshTokens()?null:this.tokenHandler.getAccessToken()},t.prototype.getFRVRID=function(){return this.isLoggedIn()?this.tokenHandler.getFRVRID():null},t.prototype.isVerified=function(){return this.tokenHandler.isVerified()},t.prototype.getCredentials=function(){var t;if(this.isLoggedIn())return o(((t={})[ie.FRVR]={userID:this.tokenHandler.getFRVRID(),accessToken:this.tokenHandler.getAccessToken(),isTokenExpired:!this.tokenHandler.isAccessValid(),isVerified:this.tokenHandler.isVerified()},t),this.getThirdPartyCredentials())},t.prototype.getThirdPartyCredentials=function(){var t={};return this.providers.forEach((function(e){e&&e.isLoggedIn()&&(t[e.getPlatformId()]=e.getCredentials())})),t},t.prototype.isLoggedIn=function(){return this.tokenHandler.isAnyValid()},t.prototype.isLoggingIn=function(){return this.serviceClient.isLoggingIn()||!!this.providers.find((function(t){return t.isLoggingIn()}))},t.prototype.getCurrentPlatform=function(){return this.tokenHandler.getCurrentPlatform()},t.prototype.getAvailableLoginPlatforms=function(){return this.providers.filter((function(t){return t.isLoginSupported()})).map((function(t){return t.getPlatformId()}))},t.prototype.isPlatformAvailable=function(t){return!!this.providers.find((function(e){return e.isLoginSupported()&&e.getPlatformId()==t}))},t.prototype.isFRVRLoginEnabled=function(){return this._isFRVRLoginEnabled},t.prototype.isLogoutSupported=function(){return!this.providers.find((function(t){return!t.isLogoutSupported()}))},t.prototype.addStatusChangeListener=function(t){this.loginStatusListeners.push(t)},t.prototype.registerOnFRVR=function(t,e){return void 0===e&&(e=!0),s(this,void 0,void 0,(function(){var n=this;return a(this,(function(r){return[2,this.serviceClient.register(t).then((function(e){return n.loginToFRVR({platform:ie.FRVR,credentials:t})})).catch((function(r){if(r.type==ne.REG_CONFLICT.type&&e)return n.loginToFRVR({platform:ie.FRVR,credentials:t});throw r}))]}))}))},t.prototype.loginToFRVR=function(t){return s(this,void 0,void 0,(function(){var e=this;return a(this,(function(n){return[2,this.serviceClient.login(t).then((function(t){return t.tokenPair&&(e.tokenHandler.setAsCurrent(t.tokenPair),e.onLoginStatusChange()),t.tokenPair,i(t,["tokenPair"])}))]}))}))},t.prototype.loginThroughPlatform=function(t){return s(this,void 0,void 0,(function(){var e,n=this;return a(this,(function(r){if(!(e=t||1!=this.providers.length?this.providers.find((function(e){return e.getPlatformId()==t})):this.providers[0]))throw ne.PLATFORM_NOT_AVAILABLE;return[2,e.login().catch((function(t){throw o(o({},ne.PLATFORM_LOGIN_FAIL),{payload:{platform:e.getPlatformId(),error:t}})})).then((function(t){if(t)return n.loginWithProvider(e);throw o(o({},ne.PLATFORM_LOGIN_FAIL),{payload:{platform:e.getPlatformId()}})}))]}))}))},t.prototype.login=function(t,e){return t&&e?this.loginToFRVR({platform:t,credentials:e}):this.loginThroughPlatform(t)},t.prototype.logout=function(){this.tokenHandler.deleteTokens(),this.providers.forEach((function(t){t.logout()})),this.onLoginStatusChange()},t.prototype.mergeAccounts=function(t,e){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2]}))}))},t.prototype.initiateVerifyChallenge=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){return[2,this.serviceClient.initiateVerifyChallenge(t)]}))}))},t.prototype.initiateRecoveryChallenge=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){return[2,this.serviceClient.initiateRecoveryChallenge(t)]}))}))},t.prototype.changePassword=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){if(!this.isLoggedIn())throw ne.NOT_LOGGED_IN;return[2,this.serviceClient.changePassword(this.tokenHandler.getRefreshToken(),t)]}))}))},t.prototype.synchronizeVerifiedStatus=function(){return s(this,void 0,void 0,(function(){var t=this;return a(this,(function(e){return this.isVerified()||!this.isLoggedIn()?[2,!0]:[2,this.serviceClient.checkVerification(this.tokenHandler.currentPair).then((function(e){return!!e&&t.refreshTokens(t.tokenHandler.currentPair).then((function(){return!0}))}))]}))}))},t.prototype.authenticatedFetch=function(t,e){return s(this,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return[4,this.decorateRequestWithAuth(e)];case 1:return e=n.sent(),[2,fetch(t,e)]}}))}))},t.prototype.decorateRequestWithAuth=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return this.shouldRefreshTokens()?[4,this.refreshTokens(this.tokenHandler.currentPair)]:[3,2];case 1:e.sent(),e.label=2;case 2:if(!this.tokenHandler.isAccessValid())throw ne.NOT_LOGGED_IN;return[2,o(o({},t),{headers:o(o({"Content-Type":"application/json"},t.headers),{Authorization:"Bearer ".concat(this.tokenHandler.getAccessToken())})})]}}))}))},t.prototype.onLoginStatusChange=function(){var t=this.isLoggedIn();this.loginStatusListeners.forEach((function(e){e(t)})),this.updateProactiveRefresh()},t.prototype.getFreshAccessToken=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return this.shouldRefreshTokens()?[4,this.refreshTokens(this.tokenHandler.currentPair)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2,this.tokenHandler.getAccessToken()]}}))}))},t.prototype.shouldRefreshTokens=function(){return this.tokenHandler.shouldRefresh()},t.prototype.refreshTokens=function(t){return s(this,void 0,void 0,(function(){var e,n=this;return a(this,(function(r){return(e=this.serviceClient.refreshTokens(t)).then((function(){n.updateProactiveRefresh()})).catch((function(t){})),[2,e.catch((function(e){return s(n,void 0,void 0,(function(){var n,r;return a(this,(function(o){switch(o.label){case 0:if(n=this.providers.find((function(e){return e.getPlatformId()==t.platform})),e.type!=ee.invalidCredentials||!(null==n?void 0:n.isLoggedIn()))return[3,5];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.loginWithProvider(n)];case 2:return o.sent(),[2,!0];case 3:throw r=o.sent(),this.logout(),r;case 4:return[3,6];case 5:throw this.tokenHandler.isAccessValid()?this.updateProactiveRefresh():this.logout(),e;case 6:return[2]}}))}))}))]}))}))},t.prototype.loginWithProvider=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){return[2,this.loginToFRVR({platform:null==t?void 0:t.getPlatformId(),credentials:null==t?void 0:t.getCredentials()})]}))}))},t.prototype.updateProactiveRefresh=function(){var t=this;window.clearTimeout(this.proactiveRefreshTimeoutID),this.isLoggedIn()&&(this.proactiveRefreshTimeoutID=window.setTimeout((function(){t.refreshTokens(t.tokenHandler.currentPair)}),1e3*this.getTimeTillProactiveRefresh()))},t.prototype.getTimeTillProactiveRefresh=function(){if(!this.tokenHandler.isRefreshValid())return Number.MAX_SAFE_INTEGER;var t=this.tokenHandler.currentPair,e=.4*(t.accessIssuedAt+t.accessLifespan-Math.floor(Date.now()/1e3));return Math.max(30,e)},Object.defineProperty(t.prototype,"responseTypes",{get:function(){return ee},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"platforms",{get:function(){return ie},enumerable:!1,configurable:!0}),t}(),Ie=Object.freeze({__proto__:null});function Pe(t){window.addEventListener("focus",(function(){t.onShow()})),window.addEventListener("blur",(function(){t.onHide()}))}function Se(t){window.addEventListener("focus",(function(){t.onAudioResume(),t.onResume()})),window.addEventListener("blur",(function(){t.onSuspend(),t.onAudioSuspend()}))}var be={providers:[{name:"dev",type:"interstitial",priority:1},{name:"dev",type:"reward",priority:2}],throttling:{maxfrequency:5e3}},Ee={onGamePause:function(){},onSuspend:function(){},onResume:function(){},onAudioSuspend:function(){},onAudioResume:function(){},onShow:function(){},onHide:function(){}},_e=function(){function t(t,e,n,r,o){this.bootstrapper=t,this.postInit=e,this.preComplete=n,this.postComplete=r,this.consentProvider=o}return t.prototype.init=function(){var t=this;return this.consentProvider.consentToTerms(),this.bootstrapper.init().then((function(){return t.postInit()}))},t.prototype.setProgress=function(t){this.bootstrapper.setProgress(t)},t.prototype.complete=function(){var t=this;return this.preComplete().then((function(){return t.bootstrapper.complete()})).then((function(){return t.postComplete()}))},t}(),we=function(){function t(){}return t.prototype.getId=function(){return"empty"},t.prototype.onModulesUpdated=function(t){},t.prototype.setConfig=function(t){},t.prototype.getLogger=function(){return console},t.prototype.getBootstrapper=function(){return g},t.prototype.getConsentProvider=function(){return E},t.prototype.getAnalyticsProviders=function(){return[]},t.prototype.getAnalyticsIDProvider=function(){return ct},t.prototype.getAdsProviders=function(t){return[]},t.prototype.getIAPProvider=function(){return Ut},t.prototype.getLocalStorageProvider=function(){return f([l.providerName])},t.prototype.getCloudStorageProvider=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2,f([l.providerName])]}))}))},t.prototype.getShortcutProvider=function(){return m},t.prototype.getTrackerContextProvider=function(){return function(){return{}}},t.prototype.getNotificationsProvider=function(){return Jt},t.prototype.getCrossplay=function(){return P},t.prototype.getSocialProvider=function(){return tt},t.prototype.getTournamentsProvider=function(){return $t},t.prototype.getChallengesProvider=function(){return te},t.prototype.getProfile=function(){return w},t.prototype.getAuthProviders=function(t,e){return[]},t.prototype.getCharacteristics=function(){return A},t.prototype.getEntryPointProvider=function(){return C},t.prototype.getCommunityProvider=function(){return T},t.prototype.getAdsConfig=function(t){return s(this,void 0,void 0,(function(){return a(this,(function(e){return[2,t]}))}))},t}(),Ae=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getId=function(){return"dev"},e.prototype.getAdsProviders=function(t){return[new j,new G]},e.prototype.getIAPProvider=function(){return new Ht},e.prototype.getLocalStorageProvider=function(){return f([h.providerName,l.providerName])},e.prototype.getCloudStorageProvider=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return[2,f([h.providerName,l.providerName])]}))}))},e.prototype.getTrackerContextProvider=function(){return ft("")},e}(we);function Ce(t){for(var e={},n=0,r=Object.getOwnPropertyNames(we.prototype);n<r.length;n++){var o=r[n];"constructor"!==o&&(t[o]&&(e[o]=t[o].bind(t)))}return e}function Te(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n={},r=t.filter((function(t){return t})).map(Ce);return Object.assign.apply(Object,u([n],r,!1)),n}var Re=function(){function t(t){this.shortcutProvider=t}return t.prototype.init=function(){return this.shortcutProvider.init()},t.prototype.canCreateShortcut=function(){return this.shortcutProvider.canCreateShortcut()},t.prototype.createShortcut=function(){return this.shortcutProvider.createShortcut()},t.prototype.canCreateShortcutAsync=function(){return this.canCreateShortcut()},t.prototype.createShortcutAsync=function(){return this.createShortcut()},t}(),ke=function(){function e(){this.lifecycle=o({},Ee),this.config={}}return e.prototype.setChannel=function(t){if(this.channel){if(this.initPromise)return void this.logger.error("[FRVR-SDK] channel cannot be set after init");this.logger.warn("[FRVR-SDK] setting channel multiple times")}this.channel=t},e.prototype.init=function(e){var n=this;return void 0===e&&(e=t.Env.DEVELOPMENT),this.channel=this.buildChannelByEnv(this.channel,e),this.channel.setConfig(this.config),this.buildComponents(e),this.initPromise=this.initTracker().then((function(){return n.initComponents(e)})),this.initPromise},e.prototype.buildChannelByEnv=function(e,n){var r=n===t.Env.DEVELOPMENT?new Ae:new we;if(!e)return r;if(n===t.Env.DEVELOPMENT){var o=Ce(e);o.getAnalyticsProviders,o.getAnalyticsIDProvider,o.getCloudStorageProvider,o.getNotificationsProvider,e=Te(r,i(o,["getAnalyticsProviders","getAnalyticsIDProvider","getCloudStorageProvider","getNotificationsProvider"]))}else e=Te(r,e);return e},e.prototype.buildComponents=function(e){var n,r,i,s,a,u,h,l,p,f,g,v,m=this;if(this.logger||(this.logger=e===t.Env.PRODUCTION&&c||this.channel.getLogger()),this.channel.onModulesUpdated(this),this.logger.debug("[FRVR-SDK] building components"),this.entrypoint=this.channel.getEntryPointProvider(),this.localStorage||(this.localStorage=new d({provider:this.channel.getLocalStorageProvider(this.config.storage),logger:this.logger})),this.channel.onModulesUpdated(this),null===(n=this.config.consent)||void 0===n?void 0:n.providerName)if("tcfv2"==(null===(r=this.config.consent)||void 0===r?void 0:r.providerName))this.consentProvider=new gt(null===(i=this.config.consent)||void 0===i?void 0:i.config,this.logger);else if("cookiepro"==(null===(s=this.config.consent)||void 0===s?void 0:s.providerName)){if(!(null===(a=this.config.consent)||void 0===a?void 0:a.config))throw new Error("missing config for cookiepro");this.consentProvider=new Qt(null===(u=this.config.consent)||void 0===u?void 0:u.config,this.logger)}this.consentProvider||(this.consentProvider=null===(h=this.channel)||void 0===h?void 0:h.getConsentProvider()),this.tracker||(this.tracker=new yt({storage:this.localStorage,logger:this.logger,analyticsProviders:this.channel.getAnalyticsProviders((null===(l=this.config.tracker)||void 0===l?void 0:l.analyticsProviders)||{}),idProvider:this.channel.getAnalyticsIDProvider(this.localStorage),contextProvider:this.channel.getTrackerContextProvider((null===(p=this.config.tracker)||void 0===p?void 0:p.trackerChannelId)||(null===(f=this.channel)||void 0===f?void 0:f.getId())),consentProvider:this.consentProvider})),this.channel.onModulesUpdated(this),this.abTests||(this.abTests=new St({tracker:this.tracker,logger:this.logger})),this.ads||(this.ads=new Y({logger:this.logger,storage:this.localStorage,tracker:this.tracker,controls:this.lifecycle})),this.iap||(this.iap=new Wt({provider:this.channel.getIAPProvider(),tracker:this.tracker,logger:this.logger})),this.notifications||(this.notifications=new Yt({logger:this.logger,provider:this.channel.getNotificationsProvider(),tracker:this.tracker})),this.bootstrapper||(this.bootstrapper=new _e(this.channel.getBootstrapper(),(function(){return m.postInit()}),(function(){return m.preComplete()}),(function(){return m.postComplete()}),this.consentProvider)),this.shortcut||(this.shortcut=new Re(this.channel.getShortcutProvider())),this.crossplay||(this.crossplay=this.channel.getCrossplay(this.tracker)),this.auth||(this.auth=new ye({providers:this.channel.getAuthProviders(this.config.gameId,this.config.auth),storage:this.localStorage,env:e,config:this.config.auth}));var y=o(o({env:e},this.config.social),{gameId:null!==(v=null===(g=this.config.social)||void 0===g?void 0:g.gameId)&&void 0!==v?v:this.config.gameId});this.social||(this.social=new rt(y,{logger:this.logger,provider:this.channel.getSocialProvider(),auth:this.auth})),this.tournaments||(this.tournaments=new Xt({logger:this.logger,provider:this.channel.getTournamentsProvider()})),this.challenges=new Zt({logger:this.logger,provider:this.channel.getChallengesProvider()}),this.profile||(this.profile=this.channel.getProfile()),this.profile||(this.profile=this.channel.getProfile()),this.channelCharacteristics||(this.channelCharacteristics=this.channel.getCharacteristics()),this.community||(this.community=this.channel.getCommunityProvider())},e.prototype.initTracker=function(){var t,e;return s(this,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return[4,this.tracker.init()];case 1:return n.sent(),this.tracker.logEvent("page_loading",{}),[4,null===(e=(t=this.abTests).init)||void 0===e?void 0:e.call(t,this.config.abTests)];case 2:return n.sent(),[2]}}))}))},e.prototype.initComponents=function(e){return s(this,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return this.logger.debug("[FRVR-SDK] initialising components"),this.addDefaultListeners(e),[4,this.registerAdProvidersByChannel(this.channel)];case 1:return n.sent(),this.config.ads&&this.ads.configure(this.config.ads),e!==t.Env.DEVELOPMENT||this.config.ads||this.ads.configure(be),this.config.gameId?(this.notifications.configure({game:this.config.gameId}),this.tournaments.init(this.config.gameId)):this.logger.error("[FRVR-SDK] Missing game's name in configuration"),this.crossplay.needsConfiguration()&&(this.config.crossplay?this.crossplay.configure(this.config.crossplay):this.logger.error("[FRVR-SDK] Missing crossplay configuration")),[2]}}))}))},e.prototype.postInit=function(){return s(this,void 0,void 0,(function(){var t,e=this;return a(this,(function(n){switch(n.label){case 0:return this.logger.debug("[FRVR-SDK] post init"),[4,this.initPromise];case 1:return n.sent(),t=function(){return s(e,void 0,void 0,(function(){var t,e;return a(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.channel.getCloudStorageProvider(this.auth,this.config.cloudStorage)];case 1:return t=n.sent(),[3,3];case 2:return e=n.sent(),this.logger.error("[FRVR-SDK] error initialising cloud storage",e),[3,3];case 3:return this.cloudStorage=new d({provider:t||new l,logger:this.logger}),[2]}}))}))},[4,Promise.all([t(),this.ads.init(),s(e,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.iap.init()];case 1:return t.sent(),[4,this.iap.configure(this.config.iap)];case 2:return t.sent(),[2]}}))})),this.shortcut.init(),this.notifications.init(),this.auth.init(),s(e,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return this.config.gameId?[4,this.challenges.init(this.config.gameId,this.entrypoint)]:(this.logger.error("[FRVR-SDK] Missing game's name in configuration"),[2]);case 1:return t.sent(),[2]}}))}))])];case 2:return n.sent(),[2]}}))}))},e.prototype.preComplete=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return this.logger.debug("[FRVR-SDK] pre complete"),this.tracker.loaded(),[2]}))}))},e.prototype.postComplete=function(){return s(this,void 0,void 0,(function(){return a(this,(function(t){return this.logger.debug("[FRVR-SDK] post complete"),this.tracker.logEvent("device_info",{}),[2]}))}))},e.prototype.addDefaultListeners=function(e){this.logger.debug("[FRVR-SDK] adding default listeners"),"undefined"!=typeof window&&Pe(this.lifecycle),e===t.Env.DEVELOPMENT&&Se(this.lifecycle)},e.prototype.registerAdProvidersByChannel=function(t){var e,n;return s(this,void 0,void 0,(function(){var r,o,i,s,u;return a(this,(function(a){switch(a.label){case 0:return this.logger.debug("[FRVR-SDK] registering ads providers"),r=this.config,[4,null===(e=t.getAdsConfig)||void 0===e?void 0:e.call(t,this.config.ads)];case 1:for(r.ads=a.sent()||this.config.ads,o=t.getAdsProviders(null!==(n=this.config.ads)&&void 0!==n?n:{}),i=0,s=o;i<s.length;i++)u=s[i],this.ads.register(u);return[2]}}))}))},e}();return window.FRVR=new ke,t.ACCESS_TOKEN_KEY=ue,t.AdTracker=M,t.AdTypeProperties=N,t.Ads=Y,t.AdsDevInterstitial=j,t.AdsDevReward=G,t.AdsThrottler=H,t.AsyncStorage=d,t.Auth=ye,t.DEFAULT_ADS_CONFIG=be,t.FRVRABTests=St,t.FRVRAnalytics=ut,t.FRVRSDK=ke,t.IAP=Wt,t.IAPError=xt,t.IAPMockProvider=Ht,t.IAPPurchaseErrorCancelledByUser=jt,t.IAPPurchaseErrorUnknownProduct=Bt,t.MIN_PROACTIVE_REFRESH_INTERVAL=30,t.MemoryAsyncStorageProvider=l,t.Notifications=Yt,t.PROACTIVE_REFRESH_THRESHOLD=.6,t.PublicCredentials=Ie,t.PublicResponses=re,t.REFRESH_TOKEN_KEY=ae,t.StorageIDProvider=pt,t.TokenHandler=ce,t.Tracker=yt,t.WebIDProvider=lt,t.WebLocalStorageProvider=h,t.addDefaultWebListeners=Pe,t.addDevWebListeners=Se,t.buildStorageProvider=f,t.buildTrackerWebContextProvider=ft,t.buildWebAsyncStorage=function(t){return new d({provider:new h,logger:t})},t.consentToAllConsentProvider=_,t.defaultCharacteristics=A,t.defaultLifecycle=Ee,t.emptyAdConfigProvider=K,t.emptyAdEventLogger=F,t.emptyAdLifecycle=L,t.emptyAnalyticsIDProvider=ct,t.emptyAsyncStorage=p,t.emptyBootstrapper=g,t.emptyCommunityProvider=T,t.emptyCrossplay=P,t.emptyEntryPoint=C,t.emptyIAPProvider=Ut,t.emptyLogger=c,t.emptyNotificationsProvider=Jt,t.emptyProfile=w,t.emptyShortcutProvider=m,t.inMemoryChannelMapper=Dt,t.noConsentConsentProvider=E,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
//# sourceMappingURL=frvr-sdk.min.js.map
